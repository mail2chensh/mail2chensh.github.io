<!DOCTYPE html>



  


<html class="theme-next muse use-motion" lang="zh-CN">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />




  
  
  
  

  
    
    
  

  

  

  

  

  
    
    
    <link href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.2" rel="stylesheet" type="text/css" />


  <meta name="keywords" content="Hexo, NexT" />








  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=5.1.2" />






<meta name="description" content="ä¸¾çœ‰é—´ä»²å¤ï¼Œç»¿è«é‡Œè‰é¸£">
<meta property="og:type" content="website">
<meta property="og:title" content="Forest Mist">
<meta property="og:url" content="http://chensh.top/index.html">
<meta property="og:site_name" content="Forest Mist">
<meta property="og:description" content="ä¸¾çœ‰é—´ä»²å¤ï¼Œç»¿è«é‡Œè‰é¸£">
<meta property="og:locale" content="zh-CN">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Forest Mist">
<meta name="twitter:description" content="ä¸¾çœ‰é—´ä»²å¤ï¼Œç»¿è«é‡Œè‰é¸£">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Muse',
    sidebar: {"position":"left","display":"post","offset":12,"offset_float":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: true,
    duoshuo: {
      userId: '0',
      author: 'Author'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://chensh.top/"/>





  <title>Forest Mist</title>
  














</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-CN">

  
  
    
  

  <div class="container sidebar-position-left 
   page-home 
 ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">Forest Mist</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle">æ—¶ã¯ç¦»ã‚Œã¦ã‚‹ã¦ã‚‚ã€å›ã®å¿ƒã¯è¿‘ãã«æ„Ÿã˜ã‚‹</p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            Startseite
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            Archiv
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            Tags
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://chensh.top/2017/09/29/IDAæ’ä»¶FRIENDç¼–è¯‘æ“ä½œå®è·µ/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Chensh">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Forest Mist">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/09/29/IDAæ’ä»¶FRIENDç¼–è¯‘æ“ä½œå®è·µ/" itemprop="url">IDAæ’ä»¶FRIENDç¼–è¯‘æ“ä½œå®è·µ</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">VerÃ¶ffentlicht am</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2017-09-29T10:08:48+08:00">
                2017-09-29
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="FRIEND"><a href="#FRIEND" class="headerlink" title="FRIEND"></a>FRIEND</h1><p>ä»¥ä¸‹å®‰è£…æ­¥éª¤æ¥æºäºGitæºï¼š<a href="https://github.com/alexhude/FRIEND" target="_blank" rel="external">FRIEND</a></p>
<p>ç¿»è¯‘æ–‡ç« è¯·<a href="http://chensh.top/2017/09/06/IDA-Plugin-FRIEND/">æŸ¥çœ‹è¿™é‡Œ</a></p>
<h2 id="ä¾èµ–ç¯å¢ƒ"><a href="#ä¾èµ–ç¯å¢ƒ" class="headerlink" title="ä¾èµ–ç¯å¢ƒ"></a>ä¾èµ–ç¯å¢ƒ</h2><p>è¦ç¼–è¯‘IDAçš„æ’ä»¶ï¼Œéœ€è¦å…·å¤‡ä»¥ä¸‹ä¸€äº›ä¾èµ–æ¡ä»¶ï¼š</p>
<ul>
<li>CMake 3.3ç‰ˆæœ¬ä»¥ä¸Š</li>
<li>åœ¨MacOSæˆ–Linuxç³»ç»Ÿä¸Šéœ€è¦GCCæˆ–è€…Clangç¼–è¯‘å™¨</li>
<li>IDA SDKï¼ˆæœ¬æ–‡åŸºäº6.8ç‰ˆæœ¬çš„ï¼Œå¯ä»¥åœ¨<a href="https://pan.baidu.com/s/1sljt7GT" target="_blank" rel="external">è¿™é‡Œä¸‹è½½</a>å¯¹åº”çš„sdkï¼Œå¯†ç : yekvï¼‰</li>
<li>Hex-Rays SDK</li>
</ul>
<h3 id="å¦‚ä½•è·å–-Hex-Rays-SDK"><a href="#å¦‚ä½•è·å–-Hex-Rays-SDK" class="headerlink" title="å¦‚ä½•è·å– Hex-Rays SDK"></a>å¦‚ä½•è·å– Hex-Rays SDK</h3><p>åœ¨è‡ªå·±çš„idaåº”ç”¨åŒ…é‡Œé¢ï¼Œå¯ä»¥å°†è¯¥æ–‡ä»¶å¤¹æ‹·è´å‡ºæ¥ã€‚</p>
<p><img src="https://ws3.sinaimg.cn/large/006tNc79gy1fjxc4vezi7j314k0vgtkk.jpg" alt=""></p>
<h3 id="å¦‚ä½•å®‰è£…CMake"><a href="#å¦‚ä½•å®‰è£…CMake" class="headerlink" title="å¦‚ä½•å®‰è£…CMake"></a>å¦‚ä½•å®‰è£…CMake</h3><p>å¯ä»¥åˆ°CMakeçš„<a href="https://cmake.org/download/" target="_blank" rel="external">å®˜ç½‘ä¸Šé¢</a>ä¸‹è½½å¯¹åº”å¹³å°çš„å®‰è£…åŒ…ã€‚</p>
<p>å®‰è£…åï¼Œå¯èƒ½åœ¨å‘½ä»¤è¡Œé‡Œé¢ä¾æ—§ä¼šæ‰¾ä¸åˆ°cmakeè¿™ä¸ªå‘½ä»¤ï¼Œè¿™ä¸ªæ—¶å€™éœ€è¦æ·»åŠ ä»¥ä¸‹ç¯å¢ƒå˜é‡ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">PATH=&quot;/Applications/CMake.app/Contents/bin&quot;:&quot;$PATH&quot;</div></pre></td></tr></table></figure>
<p>è¿™ä¸ªæ—¶å€™cmakeå‘½ä»¤å°±å¯ä»¥åœ¨ç»ˆç«¯ä¸‹ä½¿ç”¨äº†ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">$ cmake </div><div class="line">Usage</div><div class="line"></div><div class="line">  cmake [options] &lt;path-to-source&gt;</div><div class="line">  cmake [options] &lt;path-to-existing-build&gt;</div><div class="line"></div><div class="line">Specify a source directory to (re-)generate a build system for it in the</div><div class="line">current working directory.  Specify an existing build directory to</div><div class="line">re-generate its build system.</div><div class="line"></div><div class="line">Run &apos;cmake --help&apos; for more information.</div></pre></td></tr></table></figure>
<h2 id="å®‰è£…æ­¥éª¤"><a href="#å®‰è£…æ­¥éª¤" class="headerlink" title="å®‰è£…æ­¥éª¤"></a>å®‰è£…æ­¥éª¤</h2><h3 id="å…‹éš†å·¥ç¨‹"><a href="#å…‹éš†å·¥ç¨‹" class="headerlink" title="å…‹éš†å·¥ç¨‹"></a>å…‹éš†å·¥ç¨‹</h3><p>å°†å·¥ç¨‹å…‹éš†åˆ°æœ¬åœ°æ–‡ä»¶å¤¹ä¸­ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ git clone https://github.com/alexhude/FRIEND.git</div></pre></td></tr></table></figure>
<h3 id="åˆ›å»ºç¼–è¯‘æ–‡ä»¶å¤¹"><a href="#åˆ›å»ºç¼–è¯‘æ–‡ä»¶å¤¹" class="headerlink" title="åˆ›å»ºç¼–è¯‘æ–‡ä»¶å¤¹"></a>åˆ›å»ºç¼–è¯‘æ–‡ä»¶å¤¹</h3><p>è¿›å…¥åˆšåˆšå…‹éš†ä¸‹æ¥çš„è¿œç¨‹ä»“åº“ï¼Œåˆ›å»ºä¸€ä¸ª<strong>build</strong>æ–‡ä»¶å¤¹ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">$ mkdir _build</div><div class="line">$ cd _build</div></pre></td></tr></table></figure>
<p>è¿™é‡Œæˆ‘ä»¬ç”¨çš„æ˜¯IDA6.8ç‰ˆæœ¬ï¼Œæ‰€ä»¥éœ€è¦å¢åŠ ä¸€ä¸ªç¼–è¯‘é€‰é¡¹ <strong>DUSE_IDA6_SDK</strong>ï¼ŒæŒ‡å®šæ˜¯å¦ä¸º6.Xçš„ç‰ˆæœ¬ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ cmake -DUSE_IDA6_SDK=ON ..</div></pre></td></tr></table></figure>
<p>å¾—åˆ°ä»¥ä¸‹ç»“æœï¼š</p>
<p><img src="https://ws2.sinaimg.cn/large/006tNc79gy1fjxce5vbhmj317m0oojy9.jpg" alt=""></p>
<p>cmakeä¼šå¸®æˆ‘ä»¬åˆ›å»ºå¥½ç›¸åº”çš„makefileã€‚</p>
<h3 id="æ‹·è´SDKæ–‡ä»¶å¤¹"><a href="#æ‹·è´SDKæ–‡ä»¶å¤¹" class="headerlink" title="æ‹·è´SDKæ–‡ä»¶å¤¹"></a>æ‹·è´SDKæ–‡ä»¶å¤¹</h3><p>å°†æˆ‘ä»¬ä¸Šé¢ä¸‹è½½çš„<strong>IDA SDK6.8</strong>æ–‡ä»¶å¤¹å’Œ<strong>Hex-Rays SDK</strong>æ–‡ä»¶å¤¹æ‹·è´åˆ°<strong>FRIEND</strong>æ–‡ä»¶å¤¹ç›®å½•ä¸‹ï¼Œæ›¿æ¢åŸæœ‰çš„æ–‡ä»¶å¤¹ï¼Œæ•ˆæœå¦‚å›¾ï¼š</p>
<p><img src="https://ws2.sinaimg.cn/large/006tNc79gy1fjxcl0xvthj30bu0fk0tr.jpg" alt=""></p>
<h3 id="å¼€å§‹ç¼–è¯‘æ’ä»¶"><a href="#å¼€å§‹ç¼–è¯‘æ’ä»¶" class="headerlink" title="å¼€å§‹ç¼–è¯‘æ’ä»¶"></a>å¼€å§‹ç¼–è¯‘æ’ä»¶</h3><p>ä¹‹åæˆ‘ä»¬å°±å¯ä»¥è¿è¡Œå‘½ä»¤å¼€å§‹ç¼–è¯‘æ’ä»¶äº†ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ make</div></pre></td></tr></table></figure>
<p>ç¼–è¯‘ç»“æœå¦‚ä¸‹ï¼š </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div><div class="line">132</div><div class="line">133</div><div class="line">134</div><div class="line">135</div><div class="line">136</div><div class="line">137</div><div class="line">138</div><div class="line">139</div><div class="line">140</div><div class="line">141</div><div class="line">142</div><div class="line">143</div><div class="line">144</div><div class="line">145</div><div class="line">146</div><div class="line">147</div><div class="line">148</div><div class="line">149</div><div class="line">150</div><div class="line">151</div><div class="line">152</div><div class="line">153</div><div class="line">154</div><div class="line">155</div><div class="line">156</div><div class="line">157</div><div class="line">158</div></pre></td><td class="code"><pre><div class="line">Scanning dependencies of target capstone</div><div class="line">[  3%] Creating directories for &apos;capstone&apos;</div><div class="line">[  6%] Performing download step (git clone) for &apos;capstone&apos;</div><div class="line">Cloning into &apos;capstone&apos;...</div><div class="line">Already on &apos;master&apos;</div><div class="line">Your branch is up-to-date with &apos;origin/master&apos;.</div><div class="line">[ 10%] Performing patch step for &apos;capstone&apos;</div><div class="line">HEAD is now at a279481d Fix pp field in readPrefix for VEX3 and EVEX (#1015) (#1016)</div><div class="line">[ 13%] Performing update step for &apos;capstone&apos;</div><div class="line">Current branch master is up to date.</div><div class="line">[ 16%] Performing configure step for &apos;capstone&apos;</div><div class="line">-- The C compiler identification is AppleClang 8.1.0.8020042</div><div class="line">-- The CXX compiler identification is AppleClang 8.1.0.8020042</div><div class="line">-- Check for working C compiler: /Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/bin/cc</div><div class="line">-- Check for working C compiler: /Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/bin/cc -- works</div><div class="line">-- Detecting C compiler ABI info</div><div class="line">-- Detecting C compiler ABI info - done</div><div class="line">-- Detecting C compile features</div><div class="line">-- Detecting C compile features - done</div><div class="line">-- Check for working CXX compiler: /Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/bin/c++</div><div class="line">-- Check for working CXX compiler: /Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/bin/c++ -- works</div><div class="line">-- Detecting CXX compiler ABI info</div><div class="line">-- Detecting CXX compiler ABI info - done</div><div class="line">-- Detecting CXX compile features</div><div class="line">-- Detecting CXX compile features - done</div><div class="line">-- Configuring done</div><div class="line">-- Generating done</div><div class="line">CMake Warning:</div><div class="line">  Manually-specified variables were not used by the project:</div><div class="line"></div><div class="line">    CMAKE_CXX_FLAGS_DEBUG</div><div class="line">    CMAKE_CXX_FLAGS_MINSIZEREL</div><div class="line">    CMAKE_CXX_FLAGS_RELEASE</div><div class="line">    CMAKE_CXX_FLAGS_RELWITHDEBINFO</div><div class="line">    CMAKE_C_FLAGS_DEBUG</div><div class="line">    CMAKE_C_FLAGS_MINSIZEREL</div><div class="line">    CMAKE_C_FLAGS_RELEASE</div><div class="line">    CMAKE_C_FLAGS_RELWITHDEBINFO</div><div class="line"></div><div class="line"></div><div class="line">-- Build files have been written to: /Users/chensh/myDoc/workSpace/FRIEND/_build/third_party/capstone/src/capstone-build</div><div class="line">[ 20%] Performing build step for &apos;capstone&apos;</div><div class="line">Scanning dependencies of target capstone-static</div><div class="line">[  6%] Building C object CMakeFiles/capstone-static.dir/cs.c.o</div><div class="line">[ 12%] Building C object CMakeFiles/capstone-static.dir/MCInst.c.o</div><div class="line">[ 18%] Building C object CMakeFiles/capstone-static.dir/MCInstrDesc.c.o</div><div class="line">[ 25%] Building C object CMakeFiles/capstone-static.dir/MCRegisterInfo.c.o</div><div class="line">[ 31%] Building C object CMakeFiles/capstone-static.dir/SStream.c.o</div><div class="line">[ 37%] Building C object CMakeFiles/capstone-static.dir/utils.c.o</div><div class="line">[ 43%] Building C object CMakeFiles/capstone-static.dir/arch/ARM/ARMDisassembler.c.o</div><div class="line">[ 50%] Building C object CMakeFiles/capstone-static.dir/arch/ARM/ARMInstPrinter.c.o</div><div class="line">[ 56%] Building C object CMakeFiles/capstone-static.dir/arch/ARM/ARMMapping.c.o</div><div class="line">[ 62%] Building C object CMakeFiles/capstone-static.dir/arch/ARM/ARMModule.c.o</div><div class="line">[ 68%] Building C object CMakeFiles/capstone-static.dir/arch/AArch64/AArch64BaseInfo.c.o</div><div class="line">[ 75%] Building C object CMakeFiles/capstone-static.dir/arch/AArch64/AArch64Disassembler.c.o</div><div class="line">[ 81%] Building C object CMakeFiles/capstone-static.dir/arch/AArch64/AArch64InstPrinter.c.o</div><div class="line">[ 87%] Building C object CMakeFiles/capstone-static.dir/arch/AArch64/AArch64Mapping.c.o</div><div class="line">[ 93%] Building C object CMakeFiles/capstone-static.dir/arch/AArch64/AArch64Module.c.o</div><div class="line">[100%] Linking C static library libcapstone.a</div><div class="line">[100%] Built target capstone-static</div><div class="line">[ 23%] Performing install step for &apos;capstone&apos;</div><div class="line">[100%] Built target capstone-static</div><div class="line">Install the project...</div><div class="line">-- Install configuration: &quot;&quot;</div><div class="line">-- Installing: /Users/chensh/myDoc/workSpace/FRIEND/_build/third_party/capstone/include/capstone/arm64.h</div><div class="line">-- Installing: /Users/chensh/myDoc/workSpace/FRIEND/_build/third_party/capstone/include/capstone/arm.h</div><div class="line">-- Installing: /Users/chensh/myDoc/workSpace/FRIEND/_build/third_party/capstone/include/capstone/capstone.h</div><div class="line">-- Installing: /Users/chensh/myDoc/workSpace/FRIEND/_build/third_party/capstone/include/capstone/mips.h</div><div class="line">-- Installing: /Users/chensh/myDoc/workSpace/FRIEND/_build/third_party/capstone/include/capstone/ppc.h</div><div class="line">-- Installing: /Users/chensh/myDoc/workSpace/FRIEND/_build/third_party/capstone/include/capstone/x86.h</div><div class="line">-- Installing: /Users/chensh/myDoc/workSpace/FRIEND/_build/third_party/capstone/include/capstone/sparc.h</div><div class="line">-- Installing: /Users/chensh/myDoc/workSpace/FRIEND/_build/third_party/capstone/include/capstone/systemz.h</div><div class="line">-- Installing: /Users/chensh/myDoc/workSpace/FRIEND/_build/third_party/capstone/include/capstone/xcore.h</div><div class="line">-- Installing: /Users/chensh/myDoc/workSpace/FRIEND/_build/third_party/capstone/include/capstone/platform.h</div><div class="line">-- Installing: /Users/chensh/myDoc/workSpace/FRIEND/_build/third_party/capstone/lib/libcapstone.a</div><div class="line">[ 26%] Completed &apos;capstone&apos;</div><div class="line">[ 26%] Built target capstone</div><div class="line">Scanning dependencies of target pugixml</div><div class="line">[ 30%] Creating directories for &apos;pugixml&apos;</div><div class="line">[ 33%] Performing download step (git clone) for &apos;pugixml&apos;</div><div class="line">Cloning into &apos;pugixml&apos;...</div><div class="line">error: RPC failed; curl 56 SSLRead() return error -9806</div><div class="line">fatal: The remote end hung up unexpectedly</div><div class="line">fatal: early EOF</div><div class="line">fatal: index-pack failed</div><div class="line">Cloning into &apos;pugixml&apos;...</div><div class="line">-- Had to git clone more than once:</div><div class="line">          2 times.</div><div class="line">Already on &apos;master&apos;</div><div class="line">Your branch is up-to-date with &apos;origin/master&apos;.</div><div class="line">[ 36%] No patch step for &apos;pugixml&apos;</div><div class="line">[ 40%] Performing update step for &apos;pugixml&apos;</div><div class="line">Current branch master is up to date.</div><div class="line">[ 43%] Performing configure step for &apos;pugixml&apos;</div><div class="line">-- The C compiler identification is AppleClang 8.1.0.8020042</div><div class="line">-- The CXX compiler identification is AppleClang 8.1.0.8020042</div><div class="line">-- Check for working C compiler: /Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/bin/cc</div><div class="line">-- Check for working C compiler: /Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/bin/cc -- works</div><div class="line">-- Detecting C compiler ABI info</div><div class="line">-- Detecting C compiler ABI info - done</div><div class="line">-- Detecting C compile features</div><div class="line">-- Detecting C compile features - done</div><div class="line">-- Check for working CXX compiler: /Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/bin/c++</div><div class="line">-- Check for working CXX compiler: /Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/bin/c++ -- works</div><div class="line">-- Detecting CXX compiler ABI info</div><div class="line">-- Detecting CXX compiler ABI info - done</div><div class="line">-- Detecting CXX compile features</div><div class="line">-- Detecting CXX compile features - done</div><div class="line">-- Configuring done</div><div class="line">-- Generating done</div><div class="line">CMake Warning:</div><div class="line">  Manually-specified variables were not used by the project:</div><div class="line"></div><div class="line">    CMAKE_CXX_FLAGS_DEBUG</div><div class="line">    CMAKE_CXX_FLAGS_MINSIZEREL</div><div class="line">    CMAKE_CXX_FLAGS_RELEASE</div><div class="line">    CMAKE_CXX_FLAGS_RELWITHDEBINFO</div><div class="line">    CMAKE_C_FLAGS_DEBUG</div><div class="line">    CMAKE_C_FLAGS_MINSIZEREL</div><div class="line">    CMAKE_C_FLAGS_RELEASE</div><div class="line">    CMAKE_C_FLAGS_RELWITHDEBINFO</div><div class="line"></div><div class="line"></div><div class="line">-- Build files have been written to: /Users/chensh/myDoc/workSpace/FRIEND/_build/third_party/pugixml/src/pugixml-build</div><div class="line">[ 46%] Performing build step for &apos;pugixml&apos;</div><div class="line">Scanning dependencies of target pugixml</div><div class="line">[ 50%] Building CXX object CMakeFiles/pugixml.dir/src/pugixml.cpp.o</div><div class="line">[100%] Linking CXX static library libpugixml.a</div><div class="line">[100%] Built target pugixml</div><div class="line">[ 50%] Performing install step for &apos;pugixml&apos;</div><div class="line">[100%] Built target pugixml</div><div class="line">Install the project...</div><div class="line">-- Install configuration: &quot;&quot;</div><div class="line">-- Installing: /Users/chensh/myDoc/workSpace/FRIEND/_build/third_party/pugixml/lib/libpugixml.a</div><div class="line">-- Installing: /Users/chensh/myDoc/workSpace/FRIEND/_build/third_party/pugixml/include/pugixml.hpp</div><div class="line">-- Installing: /Users/chensh/myDoc/workSpace/FRIEND/_build/third_party/pugixml/include/pugiconfig.hpp</div><div class="line">-- Installing: /Users/chensh/myDoc/workSpace/FRIEND/_build/third_party/pugixml/lib/cmake/pugixml/pugixml-config.cmake</div><div class="line">-- Installing: /Users/chensh/myDoc/workSpace/FRIEND/_build/third_party/pugixml/lib/cmake/pugixml/pugixml-config-noconfig.cmake</div><div class="line">[ 53%] Completed &apos;pugixml&apos;</div><div class="line">[ 53%] Built target pugixml</div><div class="line">Scanning dependencies of target FRIEND.pmc64</div><div class="line">[ 56%] Building CXX object CMakeFiles/FRIEND.pmc64.dir/FRIEND/AArch64Extender.cpp.o</div><div class="line">[ 60%] Building CXX object CMakeFiles/FRIEND.pmc64.dir/FRIEND/AArch32Extender.cpp.o</div><div class="line">[ 63%] Building CXX object CMakeFiles/FRIEND.pmc64.dir/FRIEND/Documentation.cpp.o</div><div class="line">[ 66%] Building CXX object CMakeFiles/FRIEND.pmc64.dir/FRIEND/FRIEND.cpp.o</div><div class="line">[ 70%] Building CXX object CMakeFiles/FRIEND.pmc64.dir/FRIEND/FunctionSummary.cpp.o</div><div class="line">[ 73%] Building CXX object CMakeFiles/FRIEND.pmc64.dir/FRIEND/Settings.cpp.o</div><div class="line">[ 76%] Linking CXX shared module FRIEND.pmc64</div><div class="line">[ 76%] Built target FRIEND.pmc64</div><div class="line">Scanning dependencies of target FRIEND.pmc</div><div class="line">[ 80%] Building CXX object CMakeFiles/FRIEND.pmc.dir/FRIEND/AArch64Extender.cpp.o</div><div class="line">[ 83%] Building CXX object CMakeFiles/FRIEND.pmc.dir/FRIEND/AArch32Extender.cpp.o</div><div class="line">[ 86%] Building CXX object CMakeFiles/FRIEND.pmc.dir/FRIEND/Documentation.cpp.o</div><div class="line">[ 90%] Building CXX object CMakeFiles/FRIEND.pmc.dir/FRIEND/FRIEND.cpp.o</div><div class="line">[ 93%] Building CXX object CMakeFiles/FRIEND.pmc.dir/FRIEND/FunctionSummary.cpp.o</div><div class="line">[ 96%] Building CXX object CMakeFiles/FRIEND.pmc.dir/FRIEND/Settings.cpp.o</div><div class="line">[100%] Linking CXX shared module FRIEND.pmc</div><div class="line">[100%] Built target FRIEND.pmc</div></pre></td></tr></table></figure>
<p>ä¸Šé¢çš„ç¼–è¯‘è¿‡ç¨‹ï¼Œé¦–å…ˆä¼šä¸‹è½½ä¸¤ä¸ªç¬¬ä¸‰æ–¹çš„åº“ï¼Œä¸€ä¸ªæ˜¯<strong>capstone</strong><br>,ä¸€ä¸ªæ˜¯ <strong>pugixml</strong>ã€‚<br>ç„¶åå¼€å§‹ç¼–è¯‘ç›®æ ‡äºŒè¿›åˆ¶ï¼Œæœ€é‡å¾—åˆ°æˆ‘ä»¬éœ€è¦çš„æ’ä»¶æ–‡ä»¶:</p>
<p><strong>FRIEND.pmc</strong>å’Œ<strong>FRIEND.pmc64</strong></p>
<p><img src="https://ws2.sinaimg.cn/large/006tNc79gy1fjxcpaxyc8j30mw0dm0ui.jpg" alt=""></p>
<h3 id="æ‹·è´æ’ä»¶"><a href="#æ‹·è´æ’ä»¶" class="headerlink" title="æ‹·è´æ’ä»¶"></a>æ‹·è´æ’ä»¶</h3><p>å°†ç”Ÿæˆçš„ä¸¤ä¸ªæ–‡ä»¶ï¼Œæ‹·è´åˆ°åº”ç”¨çš„æ’ä»¶ç›®å½•ä¸‹ï¼Œç„¶åé‡å¯idaqåº”ç”¨ç¨‹åºã€‚</p>
<p><img src="https://ws3.sinaimg.cn/large/006tNc79gy1fjxcqsn8azj31240ouk0y.jpg" alt=""></p>
<p>é‡å¯è¿›å…¥åº”ç”¨ï¼Œæˆ‘ä»¬éšä¾¿æ‰“å¼€ä¸€ä¸ªäºŒè¿›åˆ¶æ–‡ä»¶ï¼Œç„¶åå°±å¯ä»¥åœ¨Editorèœå•é¡¹ä¸‹çš„pluginçœ‹åˆ°æˆ‘ä»¬æ–°å®‰è£…çš„æ’ä»¶ï¼š</p>
<p><img src="https://ws3.sinaimg.cn/large/006tNc79gy1fjxcryinh4j30vo0x018w.jpg" alt=""></p>
<h3 id="åŠ è½½XML"><a href="#åŠ è½½XML" class="headerlink" title="åŠ è½½XML"></a>åŠ è½½XML</h3><p>åœ¨æˆ‘ä»¬å…‹éš†çš„é¡¹ç›®å·¥ç¨‹ï¼Œé‡Œé¢æœ‰ä¸ªæ–‡ä»¶å¤¹<strong>Configurations</strong>ï¼Œå­˜æ”¾äº†ä¸€äº›xmlæ–‡ä»¶ã€‚</p>
<p><img src="https://ws1.sinaimg.cn/large/006tNc79gy1fjxcujtjobj30n60esq4h.jpg" alt=""></p>
<p>æˆ‘ä»¬é¦–æ¬¡ä½¿ç”¨FRIENDçš„æ—¶å€™ï¼Œéœ€è¦åŠ è½½ä¸€äº›xmlé…ç½®ï¼Œæ¥æ˜¾ç¤ºå¯¹åº”çš„é«˜äº®å…³é”®è¯ã€‚</p>
<p><img src="https://ws4.sinaimg.cn/large/006tNc79gy1fjxcsg7vn6j30x40sm40u.jpg" alt=""></p>
<h3 id="ä½“éªŒ"><a href="#ä½“éªŒ" class="headerlink" title="ä½“éªŒ"></a>ä½“éªŒ</h3><p>é…ç½®å¥½åï¼Œå½“æˆ‘ä»¬é¼ æ ‡å®šä½åˆ°ä¸€äº›å…³é”®è¯åï¼Œæˆ‘ä»¬å°±å¯ä»¥çœ‹åˆ°æ•ˆæœäº†ã€‚</p>
<p><img src="https://ws1.sinaimg.cn/large/006tNc79gy1fjxcsjzn8qj31120oqqbo.jpg" alt=""></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://chensh.top/2017/09/06/IDA-Plugin-FRIEND/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Chensh">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Forest Mist">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/09/06/IDA-Plugin-FRIEND/" itemprop="url">IDA Plugin: FRIEND</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">VerÃ¶ffentlicht am</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2017-09-06T00:00:26+08:00">
                2017-09-06
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="FRIEND"><a href="#FRIEND" class="headerlink" title="FRIEND"></a>FRIEND</h1><p>ä¸€ä¸ªçµæ´»æŸ¥çœ‹å¯„å­˜å™¨å’ŒæŒ‡ä»¤çš„æ–‡æ¡£æ‰©å±•å·¥å…·ã€‚</p>
<p><strong>åŸæ–‡åœ°å€ï¼š</strong> <a href="https://github.com/alexhude/FRIEND" target="_blank" rel="external">FRIEND</a></p>
<p><strong>ç¿»è¯‘ï¼š</strong> Chensh</p>
<h2 id="ç‰¹æ€§"><a href="#ç‰¹æ€§" class="headerlink" title="ç‰¹æ€§"></a>ç‰¹æ€§</h2><p>FRIENDæ˜¯ä¸€ä¸ªIDAæ’ä»¶ï¼Œç”¨äºæ”¹å–„åæ±‡ç¼–ä»¥åŠåœ¨IDAè§†å›¾é‡Œé¢å±•ç¤ºå¯„å­˜å™¨å’ŒæŒ‡ä»¤æ–‡æ¡£ã€‚</p>
<ol>
<li>ä½¿ç”¨ç¬¬ä¸‰æ–¹åº“æ¥æ”¹è¿›å¤„ç†å™¨æ¨¡å—ã€‚ï¼ˆä¾‹å¦‚Capstoneï¼‰<br><img src="https://ws4.sinaimg.cn/large/006tKfTcgy1fj7jnfyw32j310v0dvq6g.jpg" alt=""></li>
</ol>
<ol>
<li><p>å†IDAè§†å›¾å’Œåæ±‡ç¼–è§†å›¾é‡Œï¼Œå¯¹æŒ‡ä»¤å’Œå¯„å­˜å™¨è¿›è¡Œæç¤ºã€‚<br><img src="https://ws3.sinaimg.cn/large/006tKfTcgy1fj7jphlxu4j319514ltlf.jpg" alt=""></p>
</li>
<li><p>åœ¨æµè§ˆå™¨ä¸­æ˜¾ç¤ºé«˜äº®é€‰é¡¹çš„æ‰©å±•å¼•ç”¨ã€‚<br><img src="https://ws3.sinaimg.cn/large/006tKfTcgy1fj7jrby7a9j31kw0mv128.jpg" alt=""></p>
</li>
<li><p>åœ¨IDAè§†å›¾å’Œåæ±‡ç¼–è§†å›¾é‡Œæ˜¾ç¤ºå‡½æ•°åŠŸèƒ½æ‘˜è¦ã€‚<br><img src="https://ws3.sinaimg.cn/large/006tKfTcgy1fj7jtk62wej31kw0wi15v.jpg" alt=""></p>
</li>
<li><p>å¯ä»¥é€‰æ‹©ä½ æ„Ÿå…´è¶£çš„å…ƒç´ è¿›è¡Œå±•ç¤ºã€‚<br><img src="https://ws4.sinaimg.cn/large/006tKfTcgy1fj7ju6xpykj313k0ywjx4.jpg" alt=""></p>
</li>
</ol>
<h2 id="å¦‚ä½•ç¼–è¯‘"><a href="#å¦‚ä½•ç¼–è¯‘" class="headerlink" title="å¦‚ä½•ç¼–è¯‘"></a>å¦‚ä½•ç¼–è¯‘</h2><h3 id="å‡†å¤‡ç¼–è¯‘ç¯å¢ƒ"><a href="#å‡†å¤‡ç¼–è¯‘ç¯å¢ƒ" class="headerlink" title="å‡†å¤‡ç¼–è¯‘ç¯å¢ƒ"></a>å‡†å¤‡ç¼–è¯‘ç¯å¢ƒ</h3><p>æƒ³è¦ç¼–è¯‘IDAæ’ä»¶ï¼Œéœ€è¦æ»¡è¶³ä»¥ä¸‹çš„ä¾èµ–ï¼š</p>
<ul>
<li>CMake ç‰ˆæœ¬ä¸º3.3æˆ–æ›´é«˜ã€‚</li>
<li>å†Linuxæˆ–è€…MacOSä¸Šé¢ä½¿ç”¨GCCæˆ–è€…Clangï¼›Windowsä¸Šé¢ä½¿ç”¨Visual Studio 2015ã€‚</li>
<li>Gitã€‚</li>
<li>IDA SDKï¼ˆè§£å‹ä¸º<code>idasdk</code>ï¼‰</li>
<li>Hex-Rays SDKï¼ˆæ‹·è´å¹¶é‡å‘½åä¸º <code>hexrays_sdk</code>ï¼‰</li>
</ul>
<p>å°†IDA SDKçš„å†…å®¹è§£å‹åˆ°<code>idasdk</code>æ–‡ä»¶å¤¹å†…ã€‚å¹¶å°†Hex-Rays SDKæ‹·è´å¹¶é‡å‘½åä¸º<code>hexrays_sdk</code>ã€‚åœ¨Linuxæˆ–MacOSä¸Šé¢ï¼Œä½ å¯ä»¥ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤æ“ä½œï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">$ unzip /path/to/idasdk69.zip -d idasdk</div><div class="line">$ mv idasdk/idasdk69/* idasdk</div><div class="line">$ rm -r idasdk/idasdk69</div><div class="line">$ cp -r /path/to/ida/plugins/hexrays_sdk hexrays_sdk</div></pre></td></tr></table></figure>
<h3 id="Linux"><a href="#Linux" class="headerlink" title="Linux"></a>Linux</h3><p>ä½¿ç”¨ <code>cmake</code> å‘½ä»¤å‡†å¤‡ç¼–è¯‘ç¯å¢ƒï¼Œå¹¶è¿è¡Œ <code>make</code> å‘½ä»¤æ¥ç¼–è¯‘æ’ä»¶:</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">$ mkdir _build</div><div class="line">$ <span class="built_in">cd</span> _build</div><div class="line">$ cmake ..</div><div class="line">$ make</div></pre></td></tr></table></figure>
<h3 id="MacOS"><a href="#MacOS" class="headerlink" title="MacOS"></a>MacOS</h3><p>ä½¿ç”¨ <code>cmake</code> å‘½ä»¤å‡†å¤‡ç¼–è¯‘ç¯å¢ƒï¼Œå¹¶è¿è¡Œ <code>make</code> å‘½ä»¤æ¥ç¼–è¯‘æ’ä»¶:</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">$ mkdir _build</div><div class="line">$ <span class="built_in">cd</span> _build</div><div class="line">$ cmake ..</div><div class="line">$ make</div></pre></td></tr></table></figure>
<p>å¦‚æœä½ æ›´å€¾å‘äºä½¿ç”¨Xcodeå·¥ç¨‹æ¥è¿›è¡Œç¼–è¯‘ï¼Œé‚£ä½ å¯ä»¥è¿è¡Œä»¥ä¸‹å‘½ä»¤æ¥æ›¿æ¢ä¸Šé¢çš„æ­¥éª¤ï¼š</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">$ mkdir _build</div><div class="line">$ <span class="built_in">cd</span> _build</div><div class="line">$ cmake -G Xcode ..</div><div class="line">$ open FRIEND.xcodeproj <span class="comment"># or simply run xcodebuild</span></div></pre></td></tr></table></figure>
<h3 id="Windows"><a href="#Windows" class="headerlink" title="Windows"></a>Windows</h3><p>ä½¿ç”¨ <code>cmake</code> å‘½ä»¤å‡†å¤‡ç¼–è¯‘ç¯å¢ƒï¼Œå¹¶è¿è¡Œ <code>make</code> å‘½ä»¤æ¥ç¼–è¯‘æ’ä»¶:</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">$ mkdir _build</div><div class="line">$ <span class="built_in">cd</span> _build</div><div class="line">$ <span class="string">"%VS140COMNTOOLS%\..\..\VC\vcvarsall.bat"</span> x86</div><div class="line">$ cmake -G <span class="string">"Visual Studio 14 2015"</span> ..</div><div class="line">$ msbuild FRIEND.sln /p:Configuration=Release</div></pre></td></tr></table></figure>
<h2 id="å®‰è£…"><a href="#å®‰è£…" class="headerlink" title="å®‰è£…"></a>å®‰è£…</h2><p>å°†ç¼–è¯‘å‡ºæ¥çš„äºŒè¿›åˆ¶æ–‡ä»¶æ‹·è´åˆ°IDA Proçš„æ’ä»¶ç›®å½•é‡Œã€‚ä»¥ä¸‹æ˜¯ä¸åŒå¹³å°çš„é»˜è®¤è·¯å¾„ï¼š</p>
<table>
<thead>
<tr>
<th>ç³»ç»Ÿ</th>
<th>æ’ä»¶ç›®å½•</th>
</tr>
</thead>
<tbody>
<tr>
<td>Linux</td>
<td><code>/opt/ida-6.95/plugins</code></td>
</tr>
<tr>
<td>macOS</td>
<td><code>/Applications/IDA Pro 6.95/idabin/plugins</code></td>
</tr>
<tr>
<td>Windows</td>
<td><code>%ProgramFiles(x86)%\IDA 6.95\plugins</code></td>
</tr>
</tbody>
</table>
<h2 id="é…ç½®æ–‡ä»¶"><a href="#é…ç½®æ–‡ä»¶" class="headerlink" title="é…ç½®æ–‡ä»¶"></a>é…ç½®æ–‡ä»¶</h2><p>å†…å®¹è®¨è®ºè¯·æŸ¥çœ‹ <a href="https://github.com/alexhude/FRIEND/issues/1" target="_blank" rel="external">è¿™é‡Œ</a></p>
<p>FRIEND é…ç½®æ–‡ä»¶éµå¾ªä»¥ä¸‹æ–‡ä»¶ç»“æ„:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot; standalone=&quot;no&quot;?&gt;</div><div class="line">&lt;documentation&gt;</div><div class="line">	&lt;document id=&quot;pdf_id&quot; name=&quot;ARM Architecture Reference Manual&quot; version=&quot;A.k&quot;&gt;</div><div class="line">		&lt;path&gt;/path/to/your/pdf/or/link&lt;/path&gt;</div><div class="line">	&lt;/document&gt;</div><div class="line">	&lt;elements&gt;</div><div class="line">		&lt;group type=&quot;reg&quot; name=&quot;Group Name&quot;&gt;</div><div class="line">			&lt;hint page=&quot;1&quot; header=&quot;Element Header&quot; doc_id=&quot;pdf_id&quot; token=&quot;R0&quot;&gt;info&lt;/&gt;</div><div class="line">			...</div><div class="line">		&lt;/group&gt;</div><div class="line">		&lt;group type=&quot;ins&quot; name=&quot;Group Name&quot;&gt;</div><div class="line">			&lt;hint page=&quot;2&quot; header=&quot;Element Header&quot; doc_id=&quot;pdf_id&quot; token=&quot;MOV&quot;&gt;info&lt;/&gt;</div><div class="line">			...</div><div class="line">		&lt;/group&gt;</div><div class="line">		...</div><div class="line">	&lt;/elements&gt;</div><div class="line">&lt;/documentation&gt;</div></pre></td></tr></table></figure>
<p>æ³¨æ„ï¼šä½ éœ€è¦å°†ä½ è‡ªå·±çš„pdfæ–‡ä»¶è·¯å¾„å¡«å……åˆ°ä¸Šé¢çš„\<path\>æ ‡ç­¾ï¼Œå¦åˆ™æ— æ³•åœ¨æµè§ˆå™¨è¿›è¡Œæ–‡æ¡£æ‰©å±•ã€‚</path\></p>
<h2 id="æç¤ºç¼–è¾‘å™¨"><a href="#æç¤ºç¼–è¾‘å™¨" class="headerlink" title="æç¤ºç¼–è¾‘å™¨"></a>æç¤ºç¼–è¾‘å™¨</h2><p>ä¸ºäº†ä½¿å¾—æœ¬å·¥ç¨‹æ›´åŠ å®¹æ˜“ä½¿ç”¨ï¼Œè¿™é‡Œæœ‰ä¸€ä¸ªç®€å•çš„é…ç½®ç¼–è¾‘å™¨ã€‚</p>
<p><img src="https://ws1.sinaimg.cn/large/006tKfTcgy1fj7ktpnl37j30vx0ikjv7.jpg" alt=""></p>
<p><strong>æ³¨æ„:</strong> è¿™ä¸ªç¼–è¾‘å™¨åªèƒ½åœ¨MacOSä»¥åŠä½¿ç”¨Xcode8åŠä»¥ä¸Šçš„ç¯å¢ƒæ‰èƒ½å¤Ÿç¼–è¯‘ï¼Œå…¶ä»–ç³»ç»Ÿä¸æ”¯æŒã€‚</p>
<p>ä½¿ç”¨ <code>cmake</code> å‘½ä»¤æ¥ç”ŸæˆXcodeå·¥ç¨‹ã€‚</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">$ <span class="built_in">cd</span> HintEditor/HintEditor/</div><div class="line">$ mkdir _build</div><div class="line">$ <span class="built_in">cd</span> _build</div><div class="line">$ cmake -G Xcode ..</div><div class="line">$ xcodebuild</div></pre></td></tr></table></figure>
<p>ä½¿ç”¨<code>open</code>å‘½ä»¤æ¥å¯åŠ¨åº”ç”¨ç¨‹åºï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ open Debug/HintEditor.app</div></pre></td></tr></table></figure>
<h2 id="ä¾èµ–"><a href="#ä¾èµ–" class="headerlink" title="ä¾èµ–"></a>ä¾èµ–</h2><p>FRIEND ä¾èµ–è¦æ±‚:  </p>
<ul>
<li><a href="https://www.hex-rays.com/products/ida/support/download.shtml" target="_blank" rel="external">IDA SDK</a>   </li>
<li><a href="https://github.com/aquynh/capstone" target="_blank" rel="external">Capstone</a> (ä½¿ç”¨ Patches/capstone.diff åˆ†æ”¯ç¼–è¯‘)  </li>
<li><a href="https://github.com/zeux/pugixml" target="_blank" rel="external">pugixml</a></li>
</ul>
<p>æé†’ç¼–è¾‘å™¨ä¾èµ–è¦æ±‚ï¼š</p>
<ul>
<li><a href="https://github.com/tadija/AEXML" target="_blank" rel="external">AEXML</a> (ä½¿ç”¨ Patches/aexml.diff åˆ†æ”¯ç¼–è¯‘)  </li>
</ul>
<h2 id="è´¡çŒ®è€…"><a href="#è´¡çŒ®è€…" class="headerlink" title="è´¡çŒ®è€…"></a>è´¡çŒ®è€…</h2><p>@ <strong>in7egral, mbazaliy</strong> for bug reports and all kind of support<br>@ <strong>qwertyoruiopz, iH8sn0w, Morpheus______, xerub, msolnik, marcograss, pr0x13, _argp, oleavr, brinlyau</strong> and other gang for inspiration<br>@ <strong>_kamino_</strong> for porting project to Windows and Linux<br>@ <strong>williballenthin</strong> for the idea of function summary</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://chensh.top/2017/07/08/MMeTokenDecryptå®è·µæ“ä½œ/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Chensh">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Forest Mist">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/07/08/MMeTokenDecryptå®è·µæ“ä½œ/" itemprop="url">MMeTokenDecrypt.py</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">VerÃ¶ffentlicht am</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2017-07-08T08:10:53+08:00">
                2017-07-08
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="MMeTokenDecryptå®è·µæ“ä½œ"><a href="#MMeTokenDecryptå®è·µæ“ä½œ" class="headerlink" title="MMeTokenDecryptå®è·µæ“ä½œ"></a>MMeTokenDecryptå®è·µæ“ä½œ</h1><ul>
<li>æœ¬æ–‡å®è·µæ“ä½œåŸºäº<a href="https://github.com/manwhoami/MMeTokenDecrypt" target="_blank" rel="external">MMeTokenDecrypt</a>é¡¹ç›®ã€‚</li>
<li>æŸ¥çœ‹ç¿»è¯‘è¯·è®¿é—®ï¼š<a href="https://github.com/mail2chensh/OSG_Leaning/blob/master/002_MMeTokenDecrypt/MMeTokenDecrypt%E7%BF%BB%E8%AF%91.md" target="_blank" rel="external">MMeTokenDecryptç¿»è¯‘</a></li>
<li>å®è·µè€…ï¼š Chensh</li>
</ul>
<h2 id="å‰è¨€èƒŒæ™¯"><a href="#å‰è¨€èƒŒæ™¯" class="headerlink" title="å‰è¨€èƒŒæ™¯"></a>å‰è¨€èƒŒæ™¯</h2><p>åœ¨MacOSç³»ç»Ÿçš„æ·±å¤„ï¼Œæœ‰ä¸€æŠŠç¥ç§˜çš„å°é’¥åŒ™ã€‚è¿™æŠŠå¯†é’¥ç”±44ä¸ªéšæœºå­—ç¬¦ç»„æˆï¼Œå®ƒçš„ä½œç”¨éå¸¸å¤§ã€‚</p>
<p>æœ‰å¤šå¤§ï¼Ÿå®ƒå¯ä»¥ç”¨æ¥è§£å¼€æˆ‘ä»¬å­˜å‚¨åœ¨ç³»ç»Ÿé‡Œé¢çš„æˆæƒTokenï¼</p>
<p>æˆ‘ä»¬éƒ½çŸ¥é“ï¼ˆæœªè¯»åŸæ–‡å‰æˆ‘æ ¹æœ¬å°±ä¸çŸ¥é“ï¼ŒğŸ˜†ï¼‰ï¼Œåœ¨MacOSé‡Œï¼Œç”¨æˆ·çš„æˆæƒTokenéƒ½å­˜å‚¨åœ¨<strong>/Users/*/Library/Application Support/iCloud/Accounts/</strong>è¿™ä¸ªç›®å½•ä¸‹ï¼Œä»¥ç”¨æˆ·çš„<strong>iCloudè´¦å·</strong>ï¼ˆé‚®ç®±ï¼‰ä¸ºåçš„æ–‡ä»¶ï¼Œå…¶å­˜å‚¨æ ¼å¼æ˜¯<strong>DSID</strong>ï¼Œè¿™ä¸ªæ–‡ä»¶æ˜¯åŠ å¯†è¿‡çš„ã€‚</p>
<p>é‚£å¹³å¸¸ç³»ç»Ÿéœ€è¦ç”¨åˆ°è¿™ä¸ªæ–‡ä»¶é‡Œé¢å­˜å‚¨çš„tokençš„æ—¶å€™ï¼Œæ˜¯å¦‚ä½•è§£å¯†çš„å‘¢ï¼Ÿ</p>
<p>è¿™é‡Œæ¶‰åŠå¦å¤–ä¸€ä¸ªå¯†é’¥ï¼Œè¿™ä¸ªå¯†é’¥å­˜å‚¨åœ¨ç”¨æˆ·çš„<strong>keyChain</strong>é‡Œé¢ï¼Œä¸€ä¸ªåä¸ºiCloudçš„æ¡ç›®ã€‚</p>
<p>ç³»ç»Ÿéœ€è¦è§£å¯†è¿™ä¸ªDSIDæ–‡ä»¶æ—¶ï¼Œå°±ä¼šä»keyChainé‡Œé¢æ‹¿å‡ºè§£å¯†å¯†é’¥ï¼Œè¿›è¡Œ<strong>base64ç¼–ç </strong>ï¼Œä½œä¸º<strong>Hmacç®—æ³•</strong>çš„<strong>æ¶ˆæ¯ä½“</strong>è¾“å…¥ï¼Œç„¶åå’Œä¸Šé¢æåˆ°çš„ç¥ç§˜å°é’¥åŒ™è¿›è¡Œäº†<strong>MD5åŠ å¯†</strong>ï¼Œå¾—åˆ°ä¸€æŠŠæ–°çš„é’¥åŒ™ã€‚</p>
<p>è€Œè¿™ä¸ªDSIDæ–‡ä»¶ï¼Œæ˜¯é‡‡ç”¨128ä½AESçš„CBCåŠ å¯†æ¨¡å¼åŠ å¯†çš„ã€‚CBCåŠ å¯†æ¨¡å¼å°±æ˜¯å¯†ç åˆ†ç»„é“¾æ¥æ¨¡å¼ï¼Œè¿™ç§æ¨¡å¼æ˜¯å…ˆå°†æ˜æ–‡åˆ‡åˆ†æˆè‹¥å¹²å°æ®µï¼Œç„¶åæ¯ä¸€å°æ®µä¸åˆå§‹å—æˆ–è€…ä¸Šä¸€æ®µçš„å¯†æ–‡æ®µè¿›è¡Œå¼‚æˆ–è¿ç®—åï¼Œå†ä¸å¯†é’¥ï¼ˆä¹Ÿå°±æ˜¯ä¸Šé¢<strong>æ–°</strong>äº§ç”Ÿçš„é‚£æŠŠé’¥åŒ™ï¼‰è¿›è¡ŒåŠ å¯†ã€‚å½“ç„¶ï¼Œè¿™ä¸ªè¿‡ç¨‹è¿˜æ··åˆäº†ä¸€ä¸ªç©ºçš„åˆå§‹åŒ–å‘é‡è¿›è¡Œè®¡ç®—ã€‚</p>
<p>æ‰€ä»¥ï¼Œæ ¹æ®ä¸Šæ–‡çš„åˆ†æï¼Œåªè¦æˆ‘ä»¬æ‰¾åˆ°ç³»ç»Ÿçš„ç¥ç§˜å°é’¥åŒ™å’Œæ‹¿åˆ°keyChainé‡Œé¢iCloudçš„å­˜å‚¨æ¡ç›®ï¼Œé‚£æˆ‘ä»¬å°±å¯ä»¥å°è¯•è§£å¯†DSIDè¿™ä¸ªæ–‡ä»¶ï¼Œæ‹¿åˆ°ç”¨æˆ·çš„Tokenã€‚</p>
<p>è€Œè¿™é‡Œçš„ç¥ç§˜å°é’¥åŒ™å·²ç»è¢«åŸæ–‡ä½œè€…æ‰¾åˆ°äº†å¹¶æä¾›å‡ºæ¥ï¼Œä½œè€…åœ¨åŸæ–‡é‡Œä¸»è¦é˜è¿°çš„æ˜¯<strong>keyChainé‡Œé¢å­˜åœ¨çš„bugï¼Œå¯¼è‡´è§£å¯†å¯†é’¥å®¹æ˜“è¢«æ³„éœ²</strong>ã€‚</p>
<p>é‚£ä¹ˆæ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å°±å¼€å§‹å¤ç°ä½œè€…çš„æ€è·¯ã€‚</p>
<h2 id="keyChainçš„ä¸å®‰å…¨æ€§"><a href="#keyChainçš„ä¸å®‰å…¨æ€§" class="headerlink" title="keyChainçš„ä¸å®‰å…¨æ€§"></a>keyChainçš„ä¸å®‰å…¨æ€§</h2><p>æœ¬æ¥keychainä½œä¸ºç”¨æˆ·å­˜å‚¨å¯†ç çš„è½½ä½“ï¼Œåº”è¯¥æ˜¯åšåˆ°å¾ˆå®‰å…¨çš„ï¼Œä½†è¿™é‡Œæœ‰ä¸€ä¸ªåŸæ–‡ä½œè€…è®¤ä¸ºçš„bugï¼Œæ¶æ„ç”¨æˆ·å¯ä»¥æ ¹æ®è¿™ä¸ªbugæ¥ç»•è¿‡é’¥åŒ™ä¸²å¯†ç ä»è€Œæ‹¿åˆ°keychainé‡Œé¢å­˜å‚¨çš„æ¡ç›®ã€‚å½“ç„¶ï¼Œè¿™ä¸ªç»•è¿‡æ–¹å¼æ˜¯æœ‰æ¡ä»¶çš„ï¼Œä»¥ä¸‹åˆ†åˆ«ä»‹ç»ä¸¤ç§æƒ…å†µã€‚</p>
<h4 id="å½“ç”¨æˆ·æ²¡æœ‰è®¾é˜²"><a href="#å½“ç”¨æˆ·æ²¡æœ‰è®¾é˜²" class="headerlink" title="å½“ç”¨æˆ·æ²¡æœ‰è®¾é˜²"></a>å½“ç”¨æˆ·æ²¡æœ‰è®¾é˜²</h4><p>æˆ‘ä»¬é¦–å…ˆæ‰“å¼€keychainåº”ç”¨(Spotlighté‡Œé¢è¾“å…¥Keychain Accessè¿›è¡Œæœç´¢)ã€‚</p>
<p>ç„¶ååœ¨å·¦ä¾§<strong>ç§ç±»</strong>æ ç›®<strong>å¯†ç </strong>ä¸€é¡¹è¿›è¡Œé€‰ä¸­ï¼Œå³ä¾§å°±ä¼šå‡ºç°å­˜å‚¨åœ¨æœ¬æœºä¸Šçš„æ‰€æœ‰å®‰å…¨ä¿¡æ¯å­˜å‚¨ã€‚è¿™é‡Œè¿›è¡Œç­›é€‰ï¼Œæ‰¾åˆ°æˆ‘ä»¬çš„è¯•éªŒç›®æ ‡ï¼š<strong>Chrome Safe Storage</strong>ã€‚è¿™ä¸ªæ¡ç›®å­˜å‚¨äº†è°·æ­ŒChromeæµè§ˆå™¨çš„å®‰å…¨å­˜å‚¨ä¿¡æ¯è§£å¯†å¯†é’¥ã€‚</p>
<p><img src="https://ws1.sinaimg.cn/large/006tKfTcgy1fhb0jtvyiqj31kw087400.jpg" alt=""></p>
<p>é‚£è¦å¦‚ä½•æ‹¿åˆ°è¿™ä¸ªè§£å¯†å¯†é’¥å‘¢ï¼Ÿä¸Šæ–‡æˆ‘ä»¬å·²ç»æåŠåˆ°äº†ï¼Œè¿™é‡Œæ‰“å¼€å‘½ä»¤è¡Œã€‚è¾“å…¥ä»¥ä¸‹å‘½ä»¤ï¼š</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="meta">$</span> security find-generic-password -ga 'Chrome'</div></pre></td></tr></table></figure>
<p>è¿™é‡Œä½¿ç”¨åˆ°äº† securityå‘½ä»¤ï¼Œå®ƒæ˜¯éå¸¸å¼ºå¤§å‘½ä»¤è¡Œå®‰å…¨å·¥å…·ï¼Œä¹‹å‰æˆ‘ä»¬<a href="http://chensh.top/2017/06/30/Patching-and-ReSigning-iOS-Apps/">é‡ç­¾</a>çš„é‚£ç¯‡æ–‡ç« é‡Œé¢ä¹Ÿä½¿ç”¨åˆ°äº†è¿™ä¸ªå‘½ä»¤å»æŸ¥æ‰¾æœ‰æ•ˆçš„è¯ä¹¦ã€‚</p>
<p>è¿™é‡Œçš„å‚æ•°è§£é‡Šå¦‚ä¸‹ï¼š</p>
<ul>
<li><strong>find-generic-password</strong> å‘½ä»¤å‚æ•°ï¼Œæ˜¯ä½¿ç”¨â€œæŸ¥æ‰¾å¯†ç â€çš„åŠŸèƒ½ã€‚</li>
<li><strong>-a</strong>ï¼Œè¿™ä¸ªå‚æ•°æ˜¯åŒ¹é…ç±»å‹ä¸ºâ€œè´¦æˆ·â€çš„ï¼Œç”¨äºè¿‡æ»¤ã€‚</li>
<li><strong>-g</strong>ï¼Œè¿™ä¸ªå‚æ•°æ˜¯å°†æŸ¥è¯¢åˆ°çš„å¯†ç æ˜¾ç¤ºå‡ºæ¥ã€‚</li>
</ul>
<p>è¿è¡Œè¿™ä¸ªå‘½ä»¤åï¼Œç³»ç»Ÿé©¬ä¸Šå°±ä¼šå¼¹å‡ºä¸€ä¸ªæç¤ºæ¡†ï¼Œå¦‚ä¸‹ï¼š</p>
<p><img src="https://ws2.sinaimg.cn/large/006tKfTcgy1fhb0zu1parj30ok0badhp.jpg" alt=""></p>
<p>é‚£ä¹ˆåˆ°è¿™é‡Œï¼Œåªè¦ç”¨æˆ·ç‚¹å‡»äº†â€œå…è®¸â€æŒ‰é’®ï¼Œé‚£ä¹ˆå°±å¯ä»¥é©¬ä¸Šå¾—åˆ°å­˜å‚¨åœ¨keychainé‡Œé¢çš„å¯†é’¥äº†ã€‚å¦‚ä¸‹ï¼š</p>
<p><img src="https://ws2.sinaimg.cn/large/006tKfTcgy1fhblsp9swej30zg0ngtd0.jpg" alt=""></p>
<p>è¿™é‡Œsecurityè¯·æ±‚é’¥åŒ™ä¸²è®¿é—®çš„æƒé™ï¼Œç”¨æˆ·ç‚¹å‡»â€œå…è®¸â€åï¼Œå°±èƒ½è¯»å–åˆ°ç›¸åº”çš„passwordã€‚</p>
<p>å‡å¦‚æœ‰äººæœªç»ä½ å…è®¸æ“…åŠ¨ä½ ç”µè„‘ï¼Œè¿™ä¸ªæ—¶å€™å°±å¯ä»¥è½»è€Œæ˜“ä¸¾çš„çªƒå–äº†ä½ å¯†ç ã€‚</p>
<p>å½“ç„¶ï¼Œå¦‚æœæ˜¯è¿œç¨‹çš„æ¶æ„é»‘å®¢ï¼Œé‚£ä¹ˆæœ‰å¯èƒ½ä¼šæ— é™æ¬¡å¼¹å‡ºå¼¹çª—æç¤ºï¼Œç›´è‡³é€¼åˆ°ä½ ç‚¹å‡»â€œå…è®¸â€æŒ‰é’®ä¸ºæ­¢ã€‚</p>
<p>é‚£æˆ‘ä»¬è¯¥å¦‚ä½•é˜²èŒƒè¿™ç§æƒ…å†µå‘¢ï¼Ÿè¯·å¾€ä¸‹çœ‹ã€‚</p>
<h4 id="å½“ç”¨æˆ·å¼€å¯äº†â€œè¯¢é—®é’¥åŒ™ä¸²å¯†ç â€é€‰é¡¹"><a href="#å½“ç”¨æˆ·å¼€å¯äº†â€œè¯¢é—®é’¥åŒ™ä¸²å¯†ç â€é€‰é¡¹" class="headerlink" title="å½“ç”¨æˆ·å¼€å¯äº†â€œè¯¢é—®é’¥åŒ™ä¸²å¯†ç â€é€‰é¡¹"></a>å½“ç”¨æˆ·å¼€å¯äº†â€œè¯¢é—®é’¥åŒ™ä¸²å¯†ç â€é€‰é¡¹</h4><p>æˆ‘ä»¬å›åˆ°åˆšåˆškeychain é‡Œé¢é‚£ä¸ªchrome safe storageçš„æ¡ç›®ï¼Œå³é”®é€‰æ‹©<strong>æ˜¾ç¤ºç®€ä»‹</strong>ã€‚</p>
<p>åˆ‡æ¢åˆ°<strong>è®¿é—®æ§åˆ¶</strong>çš„é¢æ¿ï¼Œå°†<strong>è¯¢é—®é’¥åŒ™ä¸²å¯†ç </strong>é€‰ä¸­ã€‚</p>
<p><img src="https://ws3.sinaimg.cn/large/006tKfTcgy1fhblzkxuz7j30ty0jkgnl.jpg" alt=""></p>
<p>è¿™é‡Œæœ‰å¦å¤–ä¸€ä¸ªå°bugï¼Œå°±æ˜¯keychainé‡Œé¢çš„æ›´æ”¹éœ€è¦é‡å¤ä¸¤æ¬¡æ“ä½œï¼Œæ‰èƒ½çœŸæ­£çš„ä¿®æ”¹æˆåŠŸï¼Œå½“æˆ‘ä»¬å‹¾é€‰äº†è¿™ä¸ªé€‰é¡¹ï¼Œåˆ‡æ¢åˆ°<em>å±æ€§</em>ç„¶åå†åˆ‡æ¢å›æ¥çš„æ—¶å€™ï¼Œå‘ç°è¿™ä¸ªé€‰é¡¹åˆæ²¡æœ‰è¢«é€‰ä¸­ï¼Œéœ€è¦å†é‡å¤æ“ä½œä¸€éæ‰è¡Œã€‚</p>
<p>ç„¶åæˆ‘ä»¬å›åˆ°å‘½ä»¤è¡Œï¼Œé‡æ–°è¾“å…¥ä¸Šé¢securityçš„å‘½ä»¤ï¼Œè¿™ä¸€æ¬¡æˆ‘ä»¬å‘ç°å¼¹çª—å‡ºæ¥ä¸ä¸€æ ·äº†ã€‚è¿™é‡Œéœ€è¦æˆ‘ä»¬è¾“å…¥é’¥åŒ™ä¸²å¯†ç ã€‚</p>
<p><img src="https://ws4.sinaimg.cn/large/006tKfTcgy1fhbm32ymorj30oe0b8tao.jpg" alt=""></p>
<p>æ‰€ä»¥å½“æˆ‘ä»¬å¼€å¯äº†è¿™ä¸ªé€‰é¡¹ï¼Œå°±ç®—åˆ«äººå·å·ç”¨ä½ çš„ç”µè„‘ï¼Œæ²¡æœ‰ä½ çš„é’¥åŒ™ä¸²å¯†ç ï¼Œä¹Ÿæ— æ³•å¾—åˆ°å…¶ä¸­çš„å®‰å…¨ä¿¡æ¯ã€‚è¿™é‡Œå°±å¤šäº†ä¸€é“é˜²æŠ¤ã€‚</p>
<p>ä»¥ä¸Šçš„æ“ä½œæ­¥éª¤ï¼Œæˆ‘ä»¬ä¸»è¦å¯¹æ˜¯å¦å¼€å¯é’¥åŒ™ä¸²å¯†ç çš„å®‰å…¨æ€§åšä¸€ç‚¹è®¨è®ºã€‚æ¥ä¸‹æ¥æˆ‘ä»¬è¦ä½¿ç”¨è„šæœ¬æ¥è‡ªåŠ¨è·å–å¯†ç ï¼Œå¹¶ä¸”ç»“åˆç³»ç»Ÿçš„ç¥ç§˜å°é’¥åŒ™ï¼Œç”¨æ¥è§£å¯†æˆ‘ä»¬iCloudæ¡ç›®é‡Œé¢çš„Tokenã€‚</p>
<h2 id="MMeToenDecrypt-py-è§£æ"><a href="#MMeToenDecrypt-py-è§£æ" class="headerlink" title="MMeToenDecrypt.py è§£æ"></a>MMeToenDecrypt.py è§£æ</h2><p>å…ˆå¼•å…¥æ‰€éœ€è¦çš„åº“ã€‚</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> base64, hashlib, hmac, subprocess, sys, glob, os, binasicc</div><div class="line"><span class="keyword">from</span> Foundation <span class="keyword">import</span> NSData, NSPropertyListSerialization</div></pre></td></tr></table></figure>
<ul>
<li>base64ç”¨æ¥åŠ å¯†iCloudçš„é’¥åŒ™ã€‚</li>
<li>hashlibç”¨äºè®¡ç®—md5</li>
<li>subprocessç”¨äºforkä¸€ä¸ªå­è¿›ç¨‹ï¼Œå¹¶è¿è¡Œä¸€ä¸ªå¤–éƒ¨ç¨‹åºã€‚</li>
</ul>
<p>æŒ‰ç…§ä¸Šé¢çš„æ–¹æ³•ï¼Œä½¿ç”¨securityå‘½ä»¤è·å–iCloudæ¡ç›®çš„å¯†ç ã€‚</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">security find-generic-password -ws 'iCloud'</div></pre></td></tr></table></figure>
<ul>
<li>-w å‚æ•°æ˜¯ç”¨äºä»…æ˜¾ç¤ºå¯†ç é¡¹ã€‚</li>
<li>-s å‚æ•°æ˜¯ç”¨äºæŒ‡å®šç±»å‹ä¸ºserverçš„æ¡ç›®ï¼Œå¹¶åŒ¹é…åé¢çš„å…³é”®è¯ã€‚</li>
</ul>
<p>åœ¨pythoné‡Œé¢ï¼Œæˆ‘ä»¬å¯ä»¥æ˜¯subprocessåº“æ¥è¿è¡Œå¤–éƒ¨ç¨‹åºï¼Œå°†shellç¯å¢ƒä¸‹å‘½ä»¤è¿è¡Œçš„ç»“æœè¿”å›åˆ°æœ¬ç¨‹åºã€‚å¦‚æœæ²¡æœ‰è·å–åˆ°ï¼Œåˆ™æ‰“å°æŠ¥é”™ä¿¡æ¯ï¼Œå†é€€å‡ºç¨‹åºã€‚</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">iCloudKey = subprocess.check_output(<span class="string">"security find-generic-password -ws 'iCloud' | awk &#123;'print $1'&#125;"</span>, shell=<span class="keyword">True</span>).replace(<span class="string">"\n"</span>, <span class="string">""</span>)</div><div class="line"><span class="keyword">if</span> iCloudKey == <span class="string">""</span>:</div><div class="line">    <span class="keyword">print</span> <span class="string">"Error getting iCloud Decryption Key"</span></div><div class="line">    sys.exit()</div></pre></td></tr></table></figure>
<p>å¾—åˆ°iCloudçš„å¯†ç åï¼Œæˆ‘ä»¬å°†å…¶è¿›è¡Œbase64ç¼–ç </p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">msg = base64.b64decode(iCloudKey)</div></pre></td></tr></table></figure>
<p>æ¥ä¸‹æ¥ä¸Šåœºçš„æ˜¯æˆ‘ä»¬é‚£æŠŠç¥ç§˜çš„å°é’¥åŒ™äº†ã€‚</p>
<p>å®ƒåœ¨æ‰€æœ‰çš„Macosç‰ˆæœ¬é‡Œé¢éƒ½ç”¨äºç”ŸæˆHmacå“ˆå¸Œã€‚å®ƒæ˜¯ç”¨äºè§£å¯†çš„å…³é”®ã€‚</p>
<p>åœ¨ä½äº<strong>/System/Library/PrivateFrameworks/AOSKit.framework/Versions/A/AOSKit</strong>è·¯å¾„ä¸‹çš„ç³»ç»Ÿåº“ï¼Œæ‰§è¡Œäº†ä¸‹é¢çš„æ–¹æ³•ï¼Œè°ƒç”¨äº†CCHmacæ¥ç”Ÿæˆä¸€ä¸ªHmacï¼Œç”¨äºè§£å¯†ç§˜é’¥ã€‚</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="type">KeychainAccountStorage</span> _generateKeyFromData:</div></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">key = <span class="string">"t9s\"lx^awe.580Gj%'ld+0LG&lt;#9xa?&gt;vb)-fkwb92[&#125;"</span></div></pre></td></tr></table></figure>
<p>å°†ä¸Šé¢å¾—åˆ°çš„iCloudKeyå’Œç³»ç»Ÿç¥ç§˜é’¥åŒ™ä½¿ç”¨hmacè¿›è¡Œmd5è®¡ç®—ã€‚</p>
<p>å¹¶å°†æˆ‘ä»¬å¾—åˆ°çš„å“ˆå¸Œå€¼è¿›è¡Œ16è¿›åˆ¶è½¬æ¢ã€‚</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">hashed = hmac.new(key, msg, digestmod=hashlib.md5).digest()</div><div class="line">hexedKey = binascii.hexlify(hashed)</div></pre></td></tr></table></figure>
<p>æˆ‘ä»¬çŸ¥é“ç”¨æˆ·çš„æˆæƒTokenéƒ½å­˜æ”¾åœ¨<strong>~/Library/Application Support/iCloud/Accounts/</strong> ä¸‹ï¼Œæ‰€ä»¥è¦éå†ä¸€ä¸‹è¯¥æ–‡ä»¶å¤¹ä¸‹é¢çš„æ–‡ä»¶ï¼Œåˆ¤æ–­æ˜¯å¦ä¸ºæˆ‘ä»¬æ‰€éœ€è¦çš„DSIDæ–‡ä»¶(çº¯æ•°å­—æ–‡ä»¶å)ã€‚</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">mmeTokenFile = glob.glob(<span class="string">"%s/Library/Application Support/iCloud/Account/*"</span> % os.path.expanduser(<span class="string">"~"</span>))</div><div class="line"><span class="keyword">for</span> x <span class="keyword">in</span> mmeTokenFile:</div><div class="line">    <span class="keyword">try</span>:</div><div class="line">        int(x.split(<span class="string">"/"</span>)[<span class="number">-1</span>])</div><div class="line">        mmeTokenFile = x</div><div class="line">    <span class="keyword">except</span>:</div><div class="line">        <span class="keyword">continue</span></div><div class="line"><span class="keyword">if</span> <span class="keyword">not</span> isinstance(mmeTokenFile, str):</div><div class="line">    <span class="keyword">print</span><span class="string">"Could not find MMeTokenFile. You can specify the file manually"</span></div><div class="line">  	sys.exit()</div><div class="line"><span class="keyword">else</span>:</div><div class="line">    <span class="keyword">print</span> <span class="string">"Decrypting token plist -&gt; [%s]\n"</span> % mmeTokenFile</div></pre></td></tr></table></figure>
<p>æ¥ä¸‹æ¥æˆ‘ä»¬ä½¿ç”¨opensslè¿™ä¸ªå‘½ä»¤è¡Œå·¥å…·ï¼Œå°†ä¸€ä¸ªç©ºçš„åˆå§‹åŒ–å‘é‡IVå’Œä¸Šé¢å·²ç»è¢«16è¿›åˆ¶è½¬æ¢çš„å¯†é’¥ï¼Œä»¥åŠæˆ‘ä»¬æ‰¾åˆ°DSIDæ–‡ä»¶ï¼Œè¿›è¡Œ128ä½çš„AESè§£å¯†ã€‚</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">decryptedBinary = subprocess.check_output(<span class="string">"openssl enc -d -aes-128-cbc -iv '%s' -K %s &lt; '%s'"</span> % (IV, hexedKey, mmeTokenFile), shell=<span class="keyword">True</span>)</div></pre></td></tr></table></figure>
<p>è¿™é‡Œå¾—åˆ°çš„decryptedBinaryæ˜¯è§£å¯†å‡ºæ¥çš„äºŒè¿›åˆ¶æ•°æ®ï¼Œæˆ‘ä»¬ä½¿ç”¨Foundationåº“é‡Œé¢çš„ç±»æ¥å°†å®ƒè½¬åŒ–ä¸ºå¯è¯»å–çš„plistæ ¼å¼ã€‚</p>
<p>ç„¶åéå†è¿™ä¸ªplistæ ¼å¼å¯¹è±¡ï¼Œå°†å…¶ä¸­çš„å†…å®¹æ‰“å°å‡ºæ¥ã€‚</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">binToPlist = NSData.dataWithBytes_length_(decryptedBinary, len(decryptedBinary))</div><div class="line"></div><div class="line">tokenPlist = NSPropertyListSerialization.propertyListWithData_options_format_error_(binToPlist, <span class="number">0</span>, <span class="keyword">None</span>, <span class="keyword">None</span>)[<span class="number">0</span>]</div><div class="line"></div><div class="line"><span class="keyword">print</span> <span class="string">"Successfully decrypted token plist!\n"</span></div><div class="line"><span class="keyword">print</span> <span class="string">"%s [%s -&gt; %s]"</span> % (tokenPlist[<span class="string">"appleAccountInfo"</span>][<span class="string">"primaryEmail"</span>], tokenPlist[<span class="string">"appleAccountInfo"</span>][<span class="string">"fullName"</span>], tokenPlist[<span class="string">"appleAccountInfo"</span>][<span class="string">"dsPrsID"</span>])</div><div class="line"><span class="keyword">print</span> tokenPlist[<span class="string">"tokens"</span>]</div></pre></td></tr></table></figure>
<p>è‡³æ­¤ï¼Œæˆ‘ä»¬çš„é‡ç°æ­¥éª¤åˆ°æ­¤ç»“æŸï¼Œæ•´ä¸ªæµç¨‹ä¸‹æ¥ä½ å¯ä»¥å‘ç°ï¼Œåªè¦ç”¨æˆ·ä¸å°å¿ƒç‚¹å‡»äº†â€œå…è®¸â€æŒ‰é’®ï¼Œæˆ‘ä»¬å°±å¾ˆå®¹æ˜“çš„çªƒå–åˆ°äº†iCloudé‡Œé¢çš„Tokenã€‚</p>
<p>ä½ å¯ä»¥å°è¯•åœ¨è‡ªå·±çš„æœºå­ä¸Šè¿è¡Œè¿™ä»½ä»£ç ï¼Œå‡å¦‚èƒ½å¤Ÿæ‰“å°å‡ºæ¥ç›¸å…³çš„iCloudè´¦å·Tokenï¼Œé‚£å°±è¯´æ˜ä½ æˆåŠŸé‡ç°äº†ã€‚</p>
<p><img src="https://ww1.sinaimg.cn/large/006tKfTcgy1fgpsk3r7b3j308c08c3ys.jpg" alt=""></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://chensh.top/2017/07/04/MMeTokenDecrypt/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Chensh">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Forest Mist">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/07/04/MMeTokenDecrypt/" itemprop="url">MMeTokenDecrypt</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">VerÃ¶ffentlicht am</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2017-07-04T23:05:08+08:00">
                2017-07-04
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="MMeTokenDecrypt"><a href="#MMeTokenDecrypt" class="headerlink" title="MMeTokenDecrypt"></a>MMeTokenDecrypt</h1><p><strong>åŸæ–‡é“¾æ¥ï¼š</strong> <a href="https://github.com/manwhoami/MMeTokenDecrypt" target="_blank" rel="external">MMeTokenDecrypt</a></p>
<p><strong>ä½œè€…ï¼š </strong> manwhoami</p>
<p><strong>ç¿»è¯‘ï¼š</strong>  Chensh</p>
<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>è¿™ä¸ªç¨‹åºåˆ©ç”¨äº†åœ¨<strong>macOS</strong>ä¸Šæˆæƒè®¿é—®é’¥åŒ™ä¸²çš„æµç¨‹ä¸­çš„ä¸€ä¸ªç¼ºé™·ï¼Œä½¿å¾—å¯ä»¥æ— éœ€ç”¨æˆ·èº«ä»½éªŒè¯ï¼Œå³å¯è§£å¯†æˆ–æå–å‡ºæ‰€æœ‰å­˜å‚¨åœ¨ macOS/ OS X/ OSXä¸Šé¢çš„æˆæƒä»¤ç‰Œ(Authorization Tokens)ã€‚</p>
<p>æ‰€æœ‰çš„æˆæƒä»¤ç‰Œéƒ½å­˜å‚¨åœ¨è¿™ä¸ªç›®å½•ä¸‹ï¼š<strong>/Users/*/Library/Application Support/iCloud/Accounts/DSID</strong>ã€‚ DSIDæ˜¯æ¯ä¸€ä¸ªiCloudè´¦æˆ·åœ¨è‹¹æœç³»ç»Ÿé‡Œçš„åç«¯å­˜å‚¨æ ¼å¼ã€‚</p>
<p>è¿™ä¸ª<strong>DSID</strong>æ ¼å¼æ–‡ä»¶ä½¿ç”¨äº†<strong>128ä½AESçš„CBCæ¨¡å¼</strong>[^æ³¨1] å’Œä¸€ä¸ªç©ºçš„<strong>åˆå§‹åŒ–å‘é‡</strong>è¿›è¡ŒåŠ å¯†çš„ã€‚è€Œé’ˆå¯¹è¿™ä¸ªæ–‡ä»¶çš„è§£å¯†å¯†é’¥åˆ™æ˜¯å­˜å‚¨åœ¨ç”¨æˆ·çš„<strong>é’¥åŒ™ä¸²</strong>é‡Œé¢ä¸€ä¸ªåä¸º<strong>iCloud</strong>çš„æœåŠ¡æ¡ç›®ä¸‹ï¼Œåå­—æ˜¯iCloudè´¦æˆ·ç›¸å…³çš„é‚®ä»¶åœ°å€ã€‚</p>
<p>è¿™ä¸ªè§£å¯†é’¥åŒ™è¿›è¡Œäº†base64ç¼–ç ï¼Œå¹¶ä½œä¸º<strong>Hmacç®—æ³•</strong>[^æ³¨2]ä¸­çš„æ¶ˆæ¯ä½“ï¼Œè¿›è¡Œæ ‡å‡†çš„<strong>MD5å“ˆå¸ŒåŠ å¯†</strong>ã€‚è¿™é‡Œçš„é—®é¢˜æ˜¯ï¼ŒHmacç®—æ³•é‡Œæ‰€éœ€çš„è¾“å…¥é’¥åŒ™ï¼Œè¢«è—åœ¨äº†<strong>MacOSå†…æ ¸</strong>æ·±å¤„ã€‚è¿™ä¸ªé’¥åŒ™ç”±44ä¸ªéšæœºå­—ç¬¦ç»„æˆï¼Œå®ƒæ˜¯è§£å¯†DSIDæ–‡ä»¶çš„å…³é”®ã€‚æœ¬åˆ†æ”¯å·²ç»åŒ…å«äº†è¿™ä¸ªé’¥åŒ™ï¼Œå°±æˆ‘æ‰€çŸ¥ï¼Œåˆ°ç›®å‰ä¸ºæ­¢è¿™ä¸ªé’¥åŒ™è¿˜æœªåœ¨ç½‘ä¸Šè¢«å…¬å¼€è¿‡ã€‚</p>
<h2 id="æ„ä¹‰"><a href="#æ„ä¹‰" class="headerlink" title="æ„ä¹‰"></a>æ„ä¹‰</h2><p>ç›®å‰å¸‚é¢ä¸Šçš„è½¯ä»¶æ‹¥æœ‰ç±»ä¼¼åŠŸèƒ½çš„æœ‰ä¸€æ¬¾åä¸ºâ€œ<strong>Elcomsoft Phone Breaker</strong>[^æ³¨3]â€çš„å–è¯å·¥å…·ã€‚MMeTokenDecryptæ˜¯å¼€æºçš„ï¼Œå…è®¸å¼€å‘è€…åŒ…å«è¿™ä¸ªè§£å¯†iCloudæˆæƒçš„æ–‡ä»¶åˆ°ä»–ä»¬çš„å·¥ç¨‹é‡Œã€‚</p>
<p>è‹¹æœå¿…é¡»è¦é‡æ–°è®¾è®¡é’¥åŒ™ä¸²ä¿¡æ¯ã€‚å› ä¸ºæœ¬ç¨‹åºforkäº†ä¸€ä¸ªè‹¹æœå·²ç»ç­¾åçš„äºŒè¿›åˆ¶æ–‡ä»¶ä½œä¸ºå­è¿›ç¨‹ï¼Œå½“ç”¨æˆ·çœ‹åˆ°é’¥åŒ™ä¸²è®¿é—®è¯·æ±‚å¼¹çª—æ—¶ï¼Œå¹¶æ²¡æœ‰æ„è¯†åˆ°èƒŒåçš„å±é™©ã€‚æ›´è¿›ä¸€æ­¥ï¼Œæ”»å‡»è€…å¯ä»¥é‡å¤å¼¹å‡ºé’¥åŒ™ä¸²å¼¹çª—ç»™ç”¨æˆ·ï¼Œç›´è‡³ç”¨æˆ·å…è®¸äº†é’¥åŒ™ä¸²è®¿é—®ä¸ºæ­¢ï¼Œå› ä¸ºè‹¹æœå¹¶æ²¡æœ‰ä¸ºæ‹’ç»é€‰é¡¹è®¾å®šä¸€ä¸ªè¶…æ—¶ã€‚è¿™å°†ä¼šä½¿å¾—iCloudæˆæƒä»¤ç‰Œè¢«ç›—çªƒï¼Œè€Œè¿™äº›ä»¤ç‰Œå¯ä»¥ç”¨æ¥è®¿é—®å‡ ä¹æ‰€æœ‰iCloudçš„æœåŠ¡é¡¹ç›®ï¼š<strong>iOSå¤‡ä»½ï¼ŒiCloudè”ç³»äººï¼ŒiCloud Driveï¼Œ iCloud å›¾ç‰‡åº“ï¼Œ æŸ¥æ‰¾æˆ‘çš„å¥½å‹ï¼ŒæŸ¥æ‰¾æˆ‘çš„æ‰‹æœºï¼ˆæŸ¥çœ‹æˆ‘å…¶ä»–çš„é¡¹ç›®ï¼‰</strong>ã€‚</p>
<h2 id="ä¸ŠæŠ¥åé¦ˆå†ç¨‹"><a href="#ä¸ŠæŠ¥åé¦ˆå†ç¨‹" class="headerlink" title="ä¸ŠæŠ¥åé¦ˆå†ç¨‹"></a>ä¸ŠæŠ¥åé¦ˆå†ç¨‹</h2><ul>
<li>2016å¹´10æœˆ17æ—¥å¼€å§‹è”ç³»äº†è‹¹æœï¼Œæˆ‘éå¸¸è¯¦ç»†çš„é˜è¿°äº†å¦‚ä½•ç ´åç”¨æˆ·é’¥åŒ™ä¸²æˆæƒçš„æ–¹æ³•ï¼Œå¹¶åœ¨ä¸åŒçš„macOSç³»ç»Ÿç‰ˆæœ¬ä¸­é‡ç°ã€‚</li>
<li>ç›´åˆ°2016å¹´11æœˆ6æ—¥ï¼Œæ²¡æœ‰å¾—åˆ°è‹¹æœçš„ä»»ä½•åé¦ˆã€‚(å§”å±ˆğŸ˜¢å¤±è½çš„ä½œè€…â€¦â€¦)</li>
<li>bugæŠ¥å‘ŠåŒ…å«äº†ç ´åæ•´ä¸ªé’¥åŒ™ä¸²è®¿é—®ã€‚MMeTokenDecryptåªæ˜¯è¿™ä¸ªbugçš„å…¶ä¸­ä¸€ä¸ªå®ç°ã€‚æŸ¥çœ‹æˆ‘çš„å…¶ä»–é¡¹ç›®ï¼Œ<strong>OSXChromeDecrypt</strong>æ˜¯è¿™ä¸ªbugçš„å¦å¤–ä¸€ç§å®ç°ã€‚</li>
<li>æŠ¥å‘Šä¸­æœ‰ä¸ªå€¼å¾—æ³¨æ„çš„æ‘˜å½•å¦‚ä¸‹ï¼š</li>
</ul>
<blockquote>
<p>æ­¤å¤–ï¼Œå‡å¦‚æˆ‘ä»¬æ˜¯è¿œç¨‹æ”»å‡»è€…ï¼Œå½“â€œè¯¢é—®é’¥åŒ™ä¸²å¯†ç â€çš„é€‰é¡¹æ²¡æœ‰è¢«å‹¾é€‰ï¼Œé‚£ä¹ˆæˆ‘ä»¬æœ¬è´¨ä¸Šå°±æ˜¯é€šè¿‡ä»£ç å®ç°å¼ºåˆ¶å¼¹çª—æç¤ºï¼Œè¿«ä½¿ç”¨æˆ·å•å‡»â€œå…è®¸â€æŒ‰é’®ï¼Œè¿™æ ·æˆ‘ä»¬å°±å¯ä»¥è·å¾—å¯†ç ã€‚ä½†æ˜¯ï¼Œå¦‚æœâ€œé€šè¿‡å¯†ç è®¿é—®é’¥åŒ™ä¸²â€çš„é€‰é¡¹è¢«é€‰ä¸­ï¼Œå¹¶ä¸”ç”¨æˆ·ç‚¹å‡»äº†â€œæ‹’ç»â€æŒ‰é’®ï¼Œé‚£ä¹ˆå¼ºåˆ¶æç¤ºåˆ™ä¼šå˜å¾—æ¯”è¾ƒæ£˜æ‰‹ã€‚</p>
</blockquote>
<ul>
<li>æˆ‘å·²ç»æŠŠbugçš„æŠ¥å‘Šä¸Šä¼ åˆ°æœ¬é¡¹ç›®ä¸­ï¼Œå¹¶å°†å®æ—¶åŒæ­¥è‹¹æœçš„æ›´æ–°ã€‚</li>
</ul>
<h2 id="ç”¨æ³•"><a href="#ç”¨æ³•" class="headerlink" title="ç”¨æ³•"></a>ç”¨æ³•</h2><p>è¿è¡Œpythonæ–‡ä»¶ï¼š</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="meta">$</span> python MMeDecrypt.py</div></pre></td></tr></table></figure>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line">Decrypting token plist -&gt; [/Users/bob/Library/Application Support/iCloud/Accounts/123456789]</div><div class="line"></div><div class="line">Successfully decrypted token plist!</div><div class="line"></div><div class="line">bobloblaw@gmail.com Bob Loblaw -&gt; [123456789]</div><div class="line"></div><div class="line">cloudKitToken = AQAAAABYXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX~</div><div class="line"></div><div class="line">mapsToken = AQAAAAXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX~</div><div class="line"></div><div class="line">mmeAuthToken = AQAAAABXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX=</div><div class="line"></div><div class="line">mmeBTMMInfiniteToken = AQAAAABXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX~</div><div class="line"></div><div class="line">mmeFMFAppToken = AQAAAABXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX~</div><div class="line"></div><div class="line">mmeFMIPToken = AQAAAABXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX~</div></pre></td></tr></table></figure>
<h2 id="æ³¨æ„"><a href="#æ³¨æ„" class="headerlink" title="æ³¨æ„"></a>æ³¨æ„</h2><p>å‡å¦‚ä½ æ˜¯ä½¿ç”¨ homebrew å®‰è£…çš„pythonç‰ˆæœ¬ï¼Œé‚£ä¹ˆä½ è¿è¡Œè¿™ä¸ªè„šæœ¬çš„æ—¶å€™æœ‰å¯èƒ½ä¼šé‡åˆ°ä»¥ä¸‹é”™è¯¯ï¼š</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">user@system:~/code/MMeTokenDecrypt $ python MMeDecrypt.py</div><div class="line">Traceback (most recent call last):</div><div class="line">  File "MMeDecrypt.py", line 2, in &lt;module&gt;</div><div class="line">    from Foundation import NSData, NSPropertyListSerialization</div><div class="line">ImportError: No module named Foundation</div></pre></td></tr></table></figure>
<p>æƒ³è¦è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œä½ å¯ä»¥æ‰‹åŠ¨æŒ‡å®šä¸€ä¸ªä½ ç³»ç»Ÿä¸Šé»˜è®¤çš„pythonç‰ˆæœ¬çš„å®Œæ•´çš„è·¯å¾„ã€‚</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line">user@system:~/code/MMeTokenDecrypt $ /usr/bin/python MMeDecrypt.py</div><div class="line">Decrypting token plist -&gt; [/Users/user/Library/Application Support/iCloud/Accounts/123413453]</div><div class="line"></div><div class="line">Successfully decrypted token plist!</div><div class="line"></div><div class="line">user@email.com [First Last -&gt; 123413453]</div><div class="line">&#123;</div><div class="line">    cloudKitToken = "AQAAAABXXXXXXXXXXXXXXXXXXXXXXXXXXXXX~";</div><div class="line">    mapsToken = "AQAAAAXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX~";</div><div class="line">    mmeAuthToken = "AQAAAABXXXXXXXXXXXXXXXXXXXXXXXXXXXXX=";</div><div class="line">    mmeBTMMInfiniteToken = "AQAAAABXXXXXXXXXXXXXXXXXXXXXXXXXXXXX~";</div><div class="line">    mmeFMFAppToken = "AQAAAABXXXXXXXXXXXXXXXXXXXXXXXXXXXXX~";</div><div class="line">    mmeFMIPToken = "AQAAAABXXXXXXXXXXXXXXXXXXXXXXXXXXXXX~";</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p><strong>å·²åœ¨Mac OS X EI Capitan éªŒè¯è¿‡</strong></p>
<h2 id="æ³¨é‡Š"><a href="#æ³¨é‡Š" class="headerlink" title="æ³¨é‡Š"></a>æ³¨é‡Š</h2><p><strong>æ³¨1ï¼š</strong>  AESçš„CBCåŠ å¯†æ¨¡å¼ã€‚å³ä¸ºå¯†ç åˆ†ç»„é“¾æ¥æ¨¡å¼ï¼ˆCipher Block Chaining (CBC)ï¼‰ï¼Œè¿™ç§æ¨¡å¼æ˜¯å…ˆå°†æ˜æ–‡åˆ‡åˆ†æˆè‹¥å¹²å°æ®µï¼Œç„¶åæ¯ä¸€å°æ®µä¸åˆå§‹å—æˆ–è€…ä¸Šä¸€æ®µçš„å¯†æ–‡æ®µè¿›è¡Œå¼‚æˆ–è¿ç®—åï¼Œå†ä¸å¯†é’¥è¿›è¡ŒåŠ å¯†ã€‚</p>
<p><strong>æ³¨2ï¼š</strong> Hmacç®—æ³•ï¼Œæ˜¯å¯†é’¥ç›¸å…³çš„å“ˆå¸Œè¿ç®—æ¶ˆæ¯è®¤è¯ç ï¼ŒHMACè¿ç®—åˆ©ç”¨å“ˆå¸Œç®—æ³•ï¼Œä»¥ä¸€ä¸ªå¯†é’¥å’Œä¸€ä¸ªæ¶ˆæ¯ä¸ºè¾“å…¥ï¼Œç”Ÿæˆä¸€ä¸ªæ¶ˆæ¯æ‘˜è¦ä½œä¸ºè¾“å‡ºã€‚</p>
<p><strong>æ³¨3ï¼š</strong> <a href="https://www.elcomsoft.com/eppb.html" target="_blank" rel="external">Elcomsoft Phone Breaker</a>æ˜¯Elcomsoftå…¬å¸çš„ä¸€æ¬¾æ‰‹æœºå–è¯å·¥å…·ï¼Œå…·æœ‰è§£å¯†ã€ä¸‹è½½iCloudæ–‡ä»¶å’Œå¤‡ä»½ï¼Œè·å–iCloudçš„Tokenï¼Œè§£æé’¥åŒ™ä¸²ç­‰åŠŸèƒ½ã€‚</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://chensh.top/2017/06/30/iOSåº”ç”¨æ‰“è¡¥ä¸åŠé‡ç­¾åæ“ä½œå®æˆ˜/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Chensh">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Forest Mist">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/06/30/iOSåº”ç”¨æ‰“è¡¥ä¸åŠé‡ç­¾åæ“ä½œå®æˆ˜/" itemprop="url">iOSåº”ç”¨æ‰“è¡¥ä¸åŠé‡ç­¾åæ“ä½œå®æˆ˜</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">VerÃ¶ffentlicht am</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2017-06-30T08:39:51+08:00">
                2017-06-30
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="iOS-Appsæ‰“è¡¥ä¸åŠé‡ç­¾åå®æˆ˜æ“ä½œç¬”è®°"><a href="#iOS-Appsæ‰“è¡¥ä¸åŠé‡ç­¾åå®æˆ˜æ“ä½œç¬”è®°" class="headerlink" title="iOS Appsæ‰“è¡¥ä¸åŠé‡ç­¾åå®æˆ˜æ“ä½œç¬”è®°"></a>iOS Appsæ‰“è¡¥ä¸åŠé‡ç­¾åå®æˆ˜æ“ä½œç¬”è®°</h1><p><strong>åŸæ–‡ï¼š</strong> <a href="https://github.com/mail2chensh/OSG_Leaning/blob/master/Patching_and_ReSigning_iOS_Apps.md" target="_blank" rel="external">Patching and Re-Signing iOS Apps</a></p>
<p>ä»¥ä¸‹ç¬”è®°å†…å®¹åŸºäºä¸Šé¢ğŸ‘†çš„ç¿»è¯‘æ–‡ç« åçš„å®æˆ˜æ“ä½œï¼Œæ²¡æœ‰é˜…è¯»è¿‡åŸæ–‡çš„è¯·å…ˆé˜…è¯»ä¸€éã€‚</p>
<h2 id="å·¥æ¬²å–„å…¶äº‹å¿…å…ˆåˆ©å…¶å™¨"><a href="#å·¥æ¬²å–„å…¶äº‹å¿…å…ˆåˆ©å…¶å™¨" class="headerlink" title="å·¥æ¬²å–„å…¶äº‹å¿…å…ˆåˆ©å…¶å™¨"></a>å·¥æ¬²å–„å…¶äº‹å¿…å…ˆåˆ©å…¶å™¨</h2><h4 id="1-å®‰è£…åŒ…åŠFridaåŠ¨æ€åº“"><a href="#1-å®‰è£…åŒ…åŠFridaåŠ¨æ€åº“" class="headerlink" title="1. å®‰è£…åŒ…åŠFridaåŠ¨æ€åº“"></a>1. å®‰è£…åŒ…åŠFridaåŠ¨æ€åº“</h4><p>è¯·å…ˆä¸‹è½½ä»¥ä¸‹ç´ æï¼š</p>
<ul>
<li>Appå®‰è£…åŒ…ï¼š  <a href="https://github.com/OWASP/owasp-mstg/blob/master/Crackmes/iOS/Level_01/UnCrackable_Level1.ipa" target="_blank" rel="external">UnCrackable_Level1.ipa</a></li>
<li>FridaåŠ¨æ€åº“ï¼š<a href="https://build.frida.re/frida/ios/lib/FridaGadget.dylib" target="_blank" rel="external">FridaGadget.dylib</a></li>
</ul>
<h4 id="2-mobileprovision-æ–‡ä»¶"><a href="#2-mobileprovision-æ–‡ä»¶" class="headerlink" title="2. mobileprovision æ–‡ä»¶"></a>2. mobileprovision æ–‡ä»¶</h4><p>æ‹¥æœ‰å¼€å‘è€…è´¦å·çš„ï¼Œå¯ä»¥ç›´æ¥ç™»å½•è‹¹æœå¼€å‘è€…å®˜ç½‘ï¼Œç„¶åæ–°å»ºä¸€ä¸ªApp IDã€‚</p>
<p>è¿™é‡Œæˆ‘åˆ›å»ºçš„App IDæ˜¯ï¼š <strong>com.osg.uncrack</strong></p>
<p>æ ¹æ®æ–‡ç« è¦æ±‚ï¼Œè¿›è€Œåˆ›å»ºä¸€ä¸ªprovisioningæ–‡ä»¶ï¼š <strong>COM_OSG_UNCRACK.mobileprovision</strong></p>
<h4 id="3-åˆ›å»º-entitlements-plistæ–‡ä»¶"><a href="#3-åˆ›å»º-entitlements-plistæ–‡ä»¶" class="headerlink" title="3. åˆ›å»º entitlements.plistæ–‡ä»¶"></a>3. åˆ›å»º entitlements.plistæ–‡ä»¶</h4><p>åˆ›å»ºä¸€ä¸ªæƒé™æ–‡ä»¶ï¼Œåä¸ºï¼š<strong>entitlements.plist</strong>ï¼Œç„¶åå¡«å…¥ä¸€ä¸‹å†…å®¹æ³¨æ„éœ€è¦å°†å…¶ä¸­çš„æ ‡è¯†ç¬¦æ”¹ä¸ºä½ è‡ªå·±çš„è´¦å·æ ‡è¯†ç¬¦ã€‚</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</div><div class="line"><span class="meta">&lt;!DOCTYPE plist PUBLIC "-//Apple//DTD PLIST 1.0//EN" "http://www.apple.com/DTDs/PropertyList-1.0.dtd"&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">plist</span> <span class="attr">version</span>=<span class="string">"1.0"</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">dict</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">key</span>&gt;</span>application-identifier<span class="tag">&lt;/<span class="name">key</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">string</span>&gt;</span>P683E34A2C.com.osg.uncrack<span class="tag">&lt;/<span class="name">string</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">key</span>&gt;</span>com.apple.developer.team-identifier<span class="tag">&lt;/<span class="name">key</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">string</span>&gt;</span>P683E34A2C<span class="tag">&lt;/<span class="name">string</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">key</span>&gt;</span>get-task-allow<span class="tag">&lt;/<span class="name">key</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">true</span>/&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">key</span>&gt;</span>keychain-access-groups<span class="tag">&lt;/<span class="name">key</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">array</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">string</span>&gt;</span>P683E34A2C.*<span class="tag">&lt;/<span class="name">string</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">array</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">dict</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">plist</span>&gt;</span></div></pre></td></tr></table></figure>
<h4 id="4-ä¸‹è½½å¹¶ç”Ÿæˆoptoolå·¥å…·"><a href="#4-ä¸‹è½½å¹¶ç”Ÿæˆoptoolå·¥å…·" class="headerlink" title="4. ä¸‹è½½å¹¶ç”Ÿæˆoptoolå·¥å…·"></a>4. ä¸‹è½½å¹¶ç”Ÿæˆoptoolå·¥å…·</h4><p>æ ¹æ®åŸæ–‡çš„æ“ä½œï¼Œæˆ‘ä»¬åœ¨githubä¸Šé¢å…‹éš†optoolçš„ä»“åº“ï¼Œå¹¶æ›´æ–°å­æ¨¡å—ã€‚</p>
<p><img src="https://ww1.sinaimg.cn/large/006tNbRwgy1fgjwrnkteyj30uw06otae.jpg" alt=""></p>
<p><img src="https://ww1.sinaimg.cn/large/006tNbRwgy1fgjwsvftckj31kw03wabr.jpg" alt=""></p>
<p>æ›´æ–°å®Œæ¯•åï¼Œæˆ‘ä»¬ç”¨Xcodeæ‰“å¼€å·¥ç¨‹ï¼Œè¿è¡Œä¸€ä¸‹ï¼Œå°±ä¼šç”Ÿæˆoptoolå·¥å…·äº†ã€‚åœ¨å·¥ç¨‹ç›®å½•ä¸‹çš„Produceé‡Œé¢ï¼Œå³é”®é€‰æ‹©<strong>Show in Finder</strong>ï¼Œç„¶ååœ¨æ‰“å¼€çš„æ–‡ä»¶å¤¹é‡Œé¢ï¼Œå°†æ–‡ä»¶æ‹·è´åˆ°ç›®å½•<strong>/usr/bin/</strong>ä¸‹ã€‚</p>
<p><img src="https://ww2.sinaimg.cn/large/006tNbRwgy1fgjwwzryj2j30jq0zyak4.jpg" alt=""></p>
<p>è¿™æ ·å°±å¯ä»¥åœ¨ç»ˆç«¯é‡Œé¢ç›´æ¥ä½¿ç”¨optoolè¿™ä¸ªå‘½ä»¤äº†ã€‚</p>
<p><img src="https://ww2.sinaimg.cn/large/006tNbRwgy1fgjwypdkr2j31ja0lwwj5.jpg" alt=""></p>
<h4 id="5-æŸ¥è¯¢æœ¬åœ°çš„è¯ä¹¦"><a href="#5-æŸ¥è¯¢æœ¬åœ°çš„è¯ä¹¦" class="headerlink" title="5. æŸ¥è¯¢æœ¬åœ°çš„è¯ä¹¦"></a>5. æŸ¥è¯¢æœ¬åœ°çš„è¯ä¹¦</h4><p>ä½¿ç”¨<strong>security</strong>å‘½ä»¤æŸ¥è¯¢æœ¬åœ°é’¥åŒ™ä¸²é‡Œé¢çš„è¯ä¹¦ã€‚</p>
<p><img src="https://ww1.sinaimg.cn/large/006tNbRwgy1fgjx0d7gsaj31hk054q4m.jpg" alt=""></p>
<p>è¿™é‡Œæˆ‘ä»¬å°†è¦ç”¨åˆ°çš„æ˜¯ç¬¬äºŒä¸ªï¼Œä¹Ÿå°±æ˜¯developerå¼€å‘ç¯å¢ƒä¸‹çš„è¯ä¹¦ã€‚æˆ‘ä»¬æŠŠå”¯ä¸€æ ‡è¯†ç è®°å½•ä¸‹æ¥ï¼Œä¸€ä¼šé‡ç­¾åçš„æ—¶å€™ä¼šç”¨åˆ°ã€‚</p>
<h4 id="6-å®‰è£…ios-depoy"><a href="#6-å®‰è£…ios-depoy" class="headerlink" title="6. å®‰è£…ios-depoy"></a>6. å®‰è£…ios-depoy</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">npm install -g ios-deploy</div></pre></td></tr></table></figure>
<h4 id="7-å®‰è£…Frida"><a href="#7-å®‰è£…Frida" class="headerlink" title="7. å®‰è£…Frida"></a>7. å®‰è£…Frida</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">sudo pip install frida</div></pre></td></tr></table></figure>
<p>åˆ°è¿™é‡Œï¼ŒåŸºæœ¬ä¸Šéœ€è¦çš„ä¸œè¥¿éƒ½å·²ç»å‡†å¤‡é½å…¨äº†ï¼Œæˆ‘ä»¬æ–°å»ºä¸€ä¸ªæ–‡ä»¶å¤¹<strong>resign</strong>ï¼Œå°†ä¸Šé¢æ‰€æœ‰çš„ä¸œè¥¿éƒ½æ”¾åœ¨ä¸€èµ·ï¼Œæ¥ä¸‹æ¥å°±è¦å¼€å§‹æ‰“è¡¥ä¸å’Œé‡ç­¾åäº†ã€‚</p>
<p><img src="https://ww2.sinaimg.cn/large/006tNbRwgy1fgjx3vv497j30rg07adhd.jpg" alt=""></p>
<h2 id="æ‹†åŒ…æ¸…æ´—"><a href="#æ‹†åŒ…æ¸…æ´—" class="headerlink" title="æ‹†åŒ…æ¸…æ´—"></a>æ‹†åŒ…æ¸…æ´—</h2><h4 id="1-å°†ipaåŒ…åŠ å‹ç¼©"><a href="#1-å°†ipaåŒ…åŠ å‹ç¼©" class="headerlink" title="1. å°†ipaåŒ…åŠ å‹ç¼©"></a>1. å°†ipaåŒ…åŠ å‹ç¼©</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">unzip UnCrackable_Level1.ipa</div></pre></td></tr></table></figure>
<p>å¯ä»¥çœ‹åˆ°è§£å‹å‡ºä¸€ä¸ªPayloadæ–‡ä»¶å¤¹ã€‚</p>
<p><img src="https://ww3.sinaimg.cn/large/006tKfTcgy1fgjxawbhnjj311407omz4.jpg" alt=""></p>
<h4 id="2-æ‹·è´åŠ¨æ€åº“åˆ°èµ„æºåŒ…é‡Œé¢"><a href="#2-æ‹·è´åŠ¨æ€åº“åˆ°èµ„æºåŒ…é‡Œé¢" class="headerlink" title="2. æ‹·è´åŠ¨æ€åº“åˆ°èµ„æºåŒ…é‡Œé¢"></a>2. æ‹·è´åŠ¨æ€åº“åˆ°èµ„æºåŒ…é‡Œé¢</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="meta">$</span> cp FridaGadget.dylib Payload/UnCrackable\ Level\ 1.app/</div></pre></td></tr></table></figure>
<p><img src="https://ww4.sinaimg.cn/large/006tKfTcgy1fgjxmtger6j313010c15o.jpg" alt=""></p>
<h4 id="3-é¢å¤–åŠ è½½åŠ¨æ€åº“ï¼Œä½¿ç”¨optoolæ’å…¥åŠ è½½å‘½ä»¤åˆ°äºŒè¿›åˆ¶æ–‡ä»¶"><a href="#3-é¢å¤–åŠ è½½åŠ¨æ€åº“ï¼Œä½¿ç”¨optoolæ’å…¥åŠ è½½å‘½ä»¤åˆ°äºŒè¿›åˆ¶æ–‡ä»¶" class="headerlink" title="3. é¢å¤–åŠ è½½åŠ¨æ€åº“ï¼Œä½¿ç”¨optoolæ’å…¥åŠ è½½å‘½ä»¤åˆ°äºŒè¿›åˆ¶æ–‡ä»¶"></a>3. é¢å¤–åŠ è½½åŠ¨æ€åº“ï¼Œä½¿ç”¨optoolæ’å…¥åŠ è½½å‘½ä»¤åˆ°äºŒè¿›åˆ¶æ–‡ä»¶</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="meta">$</span> optool install -c load -p "@executable_path/FridaGadget.dylib" -t Payload/UnCrackable\ Level\ 1.app/UnCrackable\ Level\ 1</div></pre></td></tr></table></figure>
<p><img src="https://ww1.sinaimg.cn/large/006tKfTcgy1fgjxomhgj6j31kw09bn04.jpg" alt=""></p>
<p>å…¶ä¸­ <strong>-c</strong> ä¸ºæŒ‡å®š <strong>load_command</strong> å‘½ä»¤ï¼Œ<strong>-p</strong> æŒ‡å®šåŠ¨æ€åº“çš„è·¯å¾„ï¼Œ <strong>-t</strong>æŒ‡å®šç›®æ ‡æ–‡ä»¶ã€‚</p>
<h4 id="4-æ‹·è´æè¿°æ–‡ä»¶ï¼Œå¹¶æ”¹åä¸ºembedded-mobileprovision"><a href="#4-æ‹·è´æè¿°æ–‡ä»¶ï¼Œå¹¶æ”¹åä¸ºembedded-mobileprovision" class="headerlink" title="4. æ‹·è´æè¿°æ–‡ä»¶ï¼Œå¹¶æ”¹åä¸ºembedded.mobileprovision"></a>4. æ‹·è´æè¿°æ–‡ä»¶ï¼Œå¹¶æ”¹åä¸ºembedded.mobileprovision</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="meta">$</span> cp COM_OSG_UNCRACK.mobileprovision Payload/UnCrackable\ Level\ 1.app/embedded.mobileprovision</div></pre></td></tr></table></figure>
<h4 id="5-å°†info-plistæ–‡ä»¶é‡Œé¢çš„åŒ…åæ›´æ”¹ä¸ºä½ è‡ªå·±çš„åŒ…å"><a href="#5-å°†info-plistæ–‡ä»¶é‡Œé¢çš„åŒ…åæ›´æ”¹ä¸ºä½ è‡ªå·±çš„åŒ…å" class="headerlink" title="5. å°†info.plistæ–‡ä»¶é‡Œé¢çš„åŒ…åæ›´æ”¹ä¸ºä½ è‡ªå·±çš„åŒ…å"></a>5. å°†info.plistæ–‡ä»¶é‡Œé¢çš„åŒ…åæ›´æ”¹ä¸ºä½ è‡ªå·±çš„åŒ…å</h4><p><img src="https://ww4.sinaimg.cn/large/006tKfTcgy1fgjxs4z6ckj30tq0y87cn.jpg" alt=""></p>
<h4 id="6-ä½¿ç”¨codesignæ¥è¿›è¡Œä»£ç ç­¾å"><a href="#6-ä½¿ç”¨codesignæ¥è¿›è¡Œä»£ç ç­¾å" class="headerlink" title="6. ä½¿ç”¨codesignæ¥è¿›è¡Œä»£ç ç­¾å"></a>6. ä½¿ç”¨codesignæ¥è¿›è¡Œä»£ç ç­¾å</h4><p><img src="https://ww3.sinaimg.cn/large/006tKfTcgy1fgjxtd3i1gj31kw0cf0x1.jpg" alt=""></p>
<h2 id="å®‰è£…è¿è¡Œ"><a href="#å®‰è£…è¿è¡Œ" class="headerlink" title="å®‰è£…è¿è¡Œ"></a>å®‰è£…è¿è¡Œ</h2><p>åˆ°è¿™é‡ŒåŸºæœ¬ä¸Šæ‰“è¡¥ä¸å’Œé‡ç­¾åå°±å®Œæˆäº†ï¼Œæ¥ä¸‹æ¥å¯ä»¥ä½¿ç”¨ios-deployè¿™ä¸ªå·¥å…·æ¥å®‰è£…åº”ç”¨åˆ°æ‰‹æœºï¼Œä¹Ÿå¯ä»¥ç›´æ¥é‡æ–°å‹ç¼©ä¸ºzipæ ¼å¼å¹¶æ”¹ä¸ºipaåç¼€æ¥å®‰è£…ã€‚</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="meta">$</span> ios-deploy --debug --bundle Payload/UnCrackable\ Level\ 1.app/</div></pre></td></tr></table></figure>
<p>å¯ä»¥çœ‹åˆ°å¯åŠ¨æˆåŠŸï¼Œå¹¶å®‰è£…åˆ°æ‰‹æœºä¸Šé¢ï¼Œè€Œä¸”è¿˜è¿›å…¥lldbçš„è°ƒè¯•æ¨¡å¼ï¼š</p>
<p><img src="https://ww3.sinaimg.cn/large/006tKfTcgy1fgjxhgrv55j31kw097tef.jpg" alt=""></p>
<p>å¦å¤–ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°ç»ˆç«¯æ‰“å°å‡ºæ¥Fridaå·²ç»è¿è¡Œï¼Œå¹¶ä¸”å¼€å¯äº†ç›‘å¬ç«¯å£ã€‚</p>
<p><img src="https://ww2.sinaimg.cn/large/006tNbRwgy1fgkemkfitgj31ak01o3z7.jpg" alt=""></p>
<p>æ¥ä¸‹æ¥æˆ‘ä»¬æ¥éªŒè¯ä¸€ä¸‹æˆ‘ä»¬çš„fridaæ˜¯å¦æˆåŠŸæ’å…¥appé‡Œé¢ã€‚</p>
<p>è¿è¡Œä¸‹é¢çš„å‘½ä»¤ï¼š</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="meta">$</span> frida-ps -U</div></pre></td></tr></table></figure>
<p>å¯ä»¥çœ‹åˆ°å¯¹åº”çš„Serverï¼š</p>
<p><img src="https://ww1.sinaimg.cn/large/006tKfTcgy1fgjxjm8zv5j30bw04kq34.jpg" alt=""></p>
<p>è‡³æ­¤ï¼Œæˆ‘ä»¬çš„é‡ç­¾åæ­¥éª¤ä¹Ÿå…¨éƒ¨å®Œæˆäº†ã€‚âœŒï¸</p>
<h2 id="æ‰“å¼€æ–°ä¸–ç•Œå¤§é—¨"><a href="#æ‰“å¼€æ–°ä¸–ç•Œå¤§é—¨" class="headerlink" title="æ‰“å¼€æ–°ä¸–ç•Œå¤§é—¨"></a>æ‰“å¼€æ–°ä¸–ç•Œå¤§é—¨</h2><p>ç„¶è€Œï¼Œå½“æˆ‘ä»¬ç»“æŸäº†ä»¥ä¸Šçš„æ“ä½œæ­¥éª¤ï¼Œæˆ‘ä»¬ä¼šè§‰å¾—æœ‰ç‚¹ç‚¹çš„å°ç©ºè™šï¼Œç”šè‡³æœ‰ç‚¹èŒ«ç„¶ï¼Ÿï¼Ÿï¼Ÿexmï¼Ÿå°±è¿™æ ·ç»“æŸäº†ï¼Ÿå¥½åƒæ²¡æœ‰å¤šå¤§çš„æ„æ€ï¼Œæ²¡æœ‰æ„Ÿå—åˆ°ä¸€ç‚¹ç‚¹æ‰“è¡¥ä¸çš„å¿«æ„Ÿã€‚</p>
<p>æˆ‘ä»¬å°†æœ¬æ–‡å®éªŒçš„UnCrackable appå®‰è£…åˆ°æ‰‹æœºåï¼Œæ‰“å¼€çš„ç•Œé¢æ˜¯è¿™æ ·çš„ï¼š</p>
<p><img src="https://ww2.sinaimg.cn/large/006tKfTcgy1fgps0g2diwj31340rw40c.jpg" alt=""></p>
<p>ä¸€ä¸ªéå¸¸ç®€æ´çš„ç•Œé¢ï¼Œè¿™é‡Œå‘Šè¯‰äº†æˆ‘ä»¬æœ‰ä¸€ä¸ªç§˜å¯†è—åœ¨äº†ä¸€ä¸ªéšè—çš„Labelï¼Œä½ æƒ³è¦é€šå…³ï¼Œå°±è¦æ‰¾å‡ºé‚£ä¸ªlabelã€‚å°†labelçš„å†…å®¹å¡«å…¥è¾“å…¥æ¡†å†…ï¼Œç‚¹å‡»æŒ‰é’®å°±å¯ä»¥è¿›è¡ŒéªŒè¯å¯†æ–‡æ˜¯å¦æ­£ç¡®ã€‚</p>
<p>ç°åœ¨æˆ‘ä»¬çš„æ‰©å±•ä»»åŠ¡å°±æ˜¯å°†å¯†æ–‡æ‰¾å‡ºæ¥ç ´è§£æ‰ã€‚</p>
<p>è¿™é‡Œçš„ç¬”è€…çš„ç®€å•æ€è·¯æ˜¯è¿™æ ·çš„ï¼šæ—¢ç„¶æœ‰ä¸€ä¸ªéšè—çš„labelåœ¨è¿™ä¸ªç•Œé¢ä¸Šï¼Œé‚£ä¹ˆåªè¦éå†è¿™ä¸ªç•Œé¢çš„å­è§†å›¾ï¼Œåˆ¤æ–­æ˜¯å¦ä¸ºlabelç±»ï¼Œå¹¶ä¸”åˆ¤æ–­æ˜¯å¦ä¸ºéšè—å±æ€§ï¼Œå¦‚æœéƒ½ç¬¦åˆï¼Œé‚£åº”è¯¥å°±æ˜¯æˆ‘ä»¬è¦æ‰¾çš„é€šè¿‡å¯†æ–‡äº†ã€‚</p>
<p>æˆ‘ä»¬å¯ä»¥å†™ä¸€ä¸ªå°å°çš„Tweakï¼Œæ¥å®ç°æˆ‘ä»¬çš„æ€è·¯ã€‚</p>
<p>Tweakå†…å®¹å¦‚ä¸‹ï¼š </p>
<p><img src="https://ww1.sinaimg.cn/large/006tKfTcgy1fgprs06ck5j31180ymte1.jpg" alt=""></p>
<p>è¿™é‡Œå¯èƒ½æœ‰æœ‹å‹ä¼šé—®ï¼Œæˆ‘æ€ä¹ˆçŸ¥é“è¯¥hookå“ªä¸ªç±»å‘¢ï¼Ÿè¿™é‡Œæœ‰å¾ˆå¤šç§æ–¹æ³•ï¼Œä¾‹å¦‚å¯ä»¥dumpåº”ç”¨çš„å¤´æ–‡ä»¶ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨Hopperæ¥æŸ¥çœ‹åæ±‡ç¼–çš„ä»£ç ï¼Œéƒ½å¯ä»¥å¾ˆå®¹æ˜“çš„æ‰¾åˆ°è¿™ä¸ªç•Œé¢ç±»ï¼Œå½“ç„¶ï¼Œæˆ‘ä»¬ä¸Šé¢å®‰è£…çš„ios-deployå·¥å…·å’ŒFridaéƒ½å¯ä»¥å®Œæˆè¿™ä¸ªåŠŸèƒ½ï¼Œè¿™é‡Œå°±ä¸ä¸€ä¸€å±•å¼€ã€‚</p>
<p>è¿™é‡Œæˆ‘ä»¬å°†è¿™ä¸ªTweakæ–‡ä»¶ç¼–è¯‘æ‰“åŒ…æˆdylibæ–‡ä»¶ï¼Œè¿™é‡Œæˆ‘å·²ç»æä¾›å¥½äº†ï¼Œçœ‹å®˜å¯ä»¥åœ¨è¿™é‡Œä¸‹è½½ï¼š</p>
<p>è¡¥ä¸åŒ…ä¸‹è½½åœ°å€ï¼š  <a href="http://7xiunj.com1.z0.glb.clouddn.com/uncracktw.dylib" target="_blank" rel="external">UncrackTw.dylib</a></p>
<p>ä¹‹åä¼šæœ‰ä¸“é¢˜ä¸“é—¨ä»‹ç»å¦‚ä½•ç¼–å†™Tweakç”Ÿæˆdylibæ–‡ä»¶çš„ï¼Œè¿™é‡Œå…ˆä¸å±•å¼€å™è¿°ã€‚</p>
<p>è¿™æ ·ä¸€æ¥ï¼Œæˆ‘ä»¬å°±å¯ä»¥é‡å¤ä¸Šé¢æˆ‘ä»¬çš„æ“ä½œäº†ï¼Œå°†æˆ‘ä»¬ä¸‹è½½çš„  <strong>UncrackTw.dylib</strong>æ–‡ä»¶ä½œä¸ºè¡¥ä¸æ’å…¥åˆ°appé‡Œé¢ï¼Œç„¶åè¿›è¡Œé‡ç­¾åï¼Œå®‰è£…åˆ°æˆ‘ä»¬çš„æœºå­åï¼Œæˆ‘ä»¬çœ‹çœ‹å‡ºæ¥çš„æ•ˆæœç•Œé¢æ˜¯è¿™æ ·çš„ï¼š</p>
<p>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œè¿™é‡Œæˆ‘ä»¬çš„è¡¥ä¸å·²ç»å°†è¿™ä¸ªç•Œé¢éšè—çš„labelæ‰¾å‡ºæ¥ï¼Œå¹¶ä¸”å°†å®ƒçš„å±æ€§ä¿®æ”¹ä¸ºå¯è§ï¼Œè¿˜æŠŠå¯†æ–‡è‡ªåŠ¨å¡«å…¥è¾“å…¥æ¡†ä¸­ï¼š</p>
<p><img src="https://ww3.sinaimg.cn/large/006tKfTcgy1fgpsdjmdczj30lo0gsgms.jpg" alt=""></p>
<p>æˆ‘ä»¬å¯ä»¥ç‚¹å‡»VerifyæŒ‰é’®æ¥éªŒè¯å¯†æ–‡æ˜¯å¦æ­£ç¡®ï¼š </p>
<p><img src="https://ww2.sinaimg.cn/large/006tKfTcgy1fgpsfbr9ifj30le0p6jsr.jpg" alt=""></p>
<p>å¯ä»¥çœ‹åˆ°ï¼Œæˆ‘ä»¬æ‰¾åˆ°äº†æ­£ç¡®çš„å¯†æ–‡ã€‚è‡³æ­¤ï¼Œæˆ‘ä»¬ä¹Ÿç®—æ˜¯æ­£å¼çš„ä½“éªŒäº†ä¸€æŠŠå°å°çš„hackã€‚</p>
<p>æ¥ä¸‹æ¥å°±å¼€å¯äº†ä¸€ä¸ªæ–°ä¸–ç•Œï¼Œæ€ä¹ˆç©å°±çœ‹å°‘å¹´ä½ äº†ï¼ï¼</p>
<p><img src="https://ww1.sinaimg.cn/large/006tKfTcgy1fgpsk3r7b3j308c08c3ys.jpg" alt=""></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://chensh.top/2017/06/30/Patching-and-ReSigning-iOS-Apps/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Chensh">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Forest Mist">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/06/30/Patching-and-ReSigning-iOS-Apps/" itemprop="url">Patching and Re-Signing iOS Apps</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">VerÃ¶ffentlicht am</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2017-06-30T08:26:23+08:00">
                2017-06-30
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="å¯¹iOS-Appsæ‰“è¡¥ä¸ä»¥åŠé‡ç­¾å"><a href="#å¯¹iOS-Appsæ‰“è¡¥ä¸ä»¥åŠé‡ç­¾å" class="headerlink" title="å¯¹iOS Appsæ‰“è¡¥ä¸ä»¥åŠé‡ç­¾å"></a>å¯¹iOS Appsæ‰“è¡¥ä¸ä»¥åŠé‡ç­¾å</h2><h5 id="åŸè‘—åœ°å€ï¼šPatching-and-Re-Signing-iOS-Apps"><a href="#åŸè‘—åœ°å€ï¼šPatching-and-Re-Signing-iOS-Apps" class="headerlink" title="åŸè‘—åœ°å€ï¼šPatching and Re-Signing iOS Apps"></a>åŸè‘—åœ°å€ï¼š<a href="http://www.vantagepoint.sg/blog/85-patching-and-re-signing-ios-apps" target="_blank" rel="external">Patching and Re-Signing iOS Apps</a></h5><h5 id="ä½œè€…ï¼š-Bernhard-Mueller"><a href="#ä½œè€…ï¼š-Bernhard-Mueller" class="headerlink" title="ä½œè€…ï¼š Bernhard Mueller"></a>ä½œè€…ï¼š Bernhard Mueller</h5><h5 id="ç¿»è¯‘ï¼š-Chensh"><a href="#ç¿»è¯‘ï¼š-Chensh" class="headerlink" title="ç¿»è¯‘ï¼š Chensh"></a>ç¿»è¯‘ï¼š Chensh</h5><h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>åœ¨æ²¡æœ‰è¶Šç‹±çš„è®¾å¤‡ä¸Šè¿è¡Œç»è¿‡ä¿®æ”¹çš„iOSäºŒè¿›åˆ¶æ–‡ä»¶ï¼Œå¬èµ·æ¥æ˜¯ä¸€ä¸ªä¸é”™çš„ä¸»æ„ï¼Œç‰¹åˆ«æ˜¯å½“ä½ çš„è¶Šç‹±æœºå­å˜ç –åï¼Œä½ æƒ³æŠŠæœºå­æ›´æ–°ä¸ºéè¶Šç‹±çš„iOSç‰ˆæœ¬çš„æ—¶å€™ï¼ˆå°½ç®¡æˆ‘å’Œæˆ‘èº«è¾¹çš„äººé‡æ¥æ²¡é‡åˆ°è¿‡è¿™ç§äº‹æƒ…ï¼‰ã€‚</p>
<p>ä½ å¯ä»¥ä½¿ç”¨è¿™ç§æŠ€æœ¯å¯¹appè¿›è¡ŒåŠ¨æ€åˆ†æï¼Œå‡å¦‚ä½ åœ¨éæ´²ï¼Œä½ å¯ä»¥åšä¸€ä¸ªè™šå‡çš„GPSå®šä½æ¥æ¬ºéª—é”åŒºçš„Pokemonï¼Œåˆä¸æƒ³è¢«è¶Šç‹±æ£€æµ‹ã€‚ä¸ç®¡å¦‚ä½•ï¼Œä½ å¯ä»¥è·Ÿç€ä¸‹é¢çš„æ•™ç¨‹æ¥ä¿®æ”¹ä¸€ä¸ªappå¹¶ä¸”é‡ç­¾ï¼Œç„¶åè®©å®ƒè¿è¡Œåœ¨ä½ æœªè¶Šç‹±çš„è®¾å¤‡ä¸Šã€‚æ³¨æ„è¿™é‡Œçš„æŠ€æœ¯å®ç°çš„å‰ææ¡ä»¶æ˜¯éœ€è¦å…ˆç ¸å£³ï¼Œç‰¹åˆ«æ˜¯æ¥è‡ªApp Storeçš„Appã€‚</p>
<p>ç”±äºè‹¹æœæœ‰ä»£ç ç­¾åç³»ç»Ÿå’Œé…ç½®æè¿°çš„è§„å®šï¼Œä½¿å¾—é‡ç­¾ä¸€ä¸ªappä¸æ˜¯ä¸€é¡¹ç®€å•çš„æŒ‘æˆ˜ã€‚å¦‚æœä¸€ä¸ªappçš„é…ç½®æè¿°æ–‡ä»¶å’Œä»£ç ç­¾åå¤´éƒ¨ä¸å®Œå…¨ä¸€è‡´ï¼Œåˆ™ä¼šè¢«iOSç³»ç»Ÿæ‹’ç»è¿è¡Œã€‚è¿™å°±è¦æ±‚ä½ éœ€è¦å­¦ä¹ è®¸å¤šç›¸å…³çš„æ¦‚å¿µâ€”â€”è¯ä¹¦ã€åŒ…åã€åº”ç”¨IDã€å›¢é˜Ÿæ ‡è¯†ç¬¦ä»¥åŠå¦‚ä½•ä½¿ç”¨è‹¹æœçš„æ„å»ºå·¥å…·å°†ä»–ä»¬ç»‘å®šåœ¨ä¸€èµ·ã€‚å®Œå…¨å¯ä»¥è¯´ï¼Œä¸ä½¿ç”¨Xcodeè¿™ç§é»˜è®¤æ–¹å¼å»æ„å»ºä¸€ä¸ªç³»ç»Ÿå¯ä»¥è¿è¡Œçš„ç‰¹å®šçš„äºŒè¿›åˆ¶æ–‡ä»¶ï¼Œæ˜¯ä¸€ä¸ªå·¨å¤§çš„æŒ‘æˆ˜ã€‚</p>
<p>æˆ‘ä»¬å°†è¦ä½¿ç”¨çš„å·¥å…·åŒ…æ‹¬<a href="https://github.com/alexzielenski/optool" target="_blank" rel="external">optool</a>,è‹¹æœçš„æ„å»ºå·¥å…·ä»¥åŠä¸€äº›Shellå‘½ä»¤ã€‚è¿™ä¸ªæ–¹æ³•ä¸­çš„é‡ç­¾è„šæœ¬çµæ„Ÿæ¥æºäº <a href="https://github.com/vtky/Swizzler2/wiki" target="_blank" rel="external">Vincent Tanâ€™s Swizzler project</a>ã€‚å¦å¤–çš„é‡æ‰“åŒ…æ¥æºäº<a href="https://www.nccgroup.trust/au/about-us/newsroom-and-events/blogs/2016/october/ios-instrumentation-without-jailbreak/" target="_blank" rel="external">NCC group</a>ã€‚</p>
<p>è¦å¤ç°ä»¥ä¸‹æ­¥éª¤ï¼Œè¯·å…ˆä¸‹è½½ä¸€ä¸ªapp:<a href="https://github.com/OWASP/owasp-mstg/blob/master/Crackmes/iOS/Level_01/UnCrackable_Level1.ipa" target="_blank" rel="external">UnCrackable iOS App Level 1</a>,æ¥è‡ªOWASPç§»åŠ¨æµ‹è¯•æŒ‡å—çš„åˆ†æ”¯ã€‚æˆ‘ä»¬çš„ç›®æ ‡æ˜¯ä½¿å¾— UnCrackable è¿™ä¸ªappåœ¨å¯åŠ¨çš„æ—¶å€™åŠ è½½ FridaGadget.dylib è¿™ä¸ªåŠ¨æ€åº“ï¼Œè¿™æ ·æˆ‘ä»¬å°±èƒ½ä½¿ç”¨Fridaæ¥è¿›è¡Œåˆ†æã€‚</p>
<h2 id="è·å–ä¸€ä»½å¼€å‘è€…é…ç½®æ–‡ä»¶å’Œè¯ä¹¦"><a href="#è·å–ä¸€ä»½å¼€å‘è€…é…ç½®æ–‡ä»¶å’Œè¯ä¹¦" class="headerlink" title="è·å–ä¸€ä»½å¼€å‘è€…é…ç½®æ–‡ä»¶å’Œè¯ä¹¦"></a>è·å–ä¸€ä»½å¼€å‘è€…é…ç½®æ–‡ä»¶å’Œè¯ä¹¦</h2><p>é…ç½®æ–‡ä»¶æ˜¯ç”±ä½ çš„ä¸€ä¸ªæˆ–å¤šä¸ªè®¾å¤‡ä¸Šçš„ä»£ç ç­¾åè¯ä¹¦é›†æˆçš„ä¸€ä»½plistæ ¼å¼çš„æ–‡ä»¶ï¼Œç”±è‹¹æœè¿›è¡Œç™½åå•ç­¾åéªŒè¯ã€‚å°±æ˜¯è¯´ï¼Œè‹¹æœæ˜ç¡®çš„è¦æ±‚ä½ çš„åº”ç”¨è¿è¡Œåœ¨æŸä¸€ç‰¹æ€§çš„ç¯å¢ƒé‡Œï¼Œä¾‹å¦‚åœ¨é€‰å®šçš„è®¾å¤‡ä¸Šè¿›è¡Œè°ƒè¯•ã€‚é…ç½®æ–‡ä»¶ä¹Ÿåˆ—å‡ºäº†ä½ çš„åº”ç”¨æ‹¥æœ‰çš„æƒé™ï¼Œè€Œä»£ç ç­¾åè¯ä¹¦é‡Œé¢åŒ…å«äº†å°†è¦ç”¨äºçœŸå®ç­¾åçš„ç§é’¥ã€‚</p>
<p>æ ¹æ®ä½ æ˜¯å¦å·²ç»æ³¨å†Œä¸ºiOSå¼€å‘è€…ï¼Œä½ å¯ä»¥é€‰æ‹©ä¸€ä¸‹ä¸¤ç§æ–¹å¼ä¹‹ä¸€å»è·å–è¯ä¹¦å’Œé…ç½®æ–‡ä»¶ã€‚</p>
<h4 id="ä½¿ç”¨iOSå¼€å‘è€…è´¦å·ï¼š"><a href="#ä½¿ç”¨iOSå¼€å‘è€…è´¦å·ï¼š" class="headerlink" title="ä½¿ç”¨iOSå¼€å‘è€…è´¦å·ï¼š"></a>ä½¿ç”¨iOSå¼€å‘è€…è´¦å·ï¼š</h4><p>å¦‚æœä½ ä¹‹å‰æ›¾ä½¿ç”¨Xcodeå¼€å‘å’Œéƒ¨ç½²è¿‡iOSåº”ç”¨ï¼Œé‚£ä¹ˆä½ å·²ç»æ‹¥æœ‰äº†ä¸€ä¸ªä»£ç ç­¾åè¯ä¹¦ã€‚ä½¿ç”¨<strong>security</strong>å·¥å…·å¯ä»¥åˆ—å‡ºä½ å½“å‰å­˜åœ¨çš„ç­¾åæ ‡å¿—ï¼š</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="meta">$</span> security find-identity -p codesigning -v</div><div class="line">1) 61FA3547E0AF42A11E233F6A2B255E6B6AF262CE "iPhone Distribution: Vantage Point Security Pte. Ltd."</div><div class="line">2) 8004380F331DCA22CC1B47FB1A805890AE41C938 "iPhone Developer: Bernhard MÃ¼ller (RV852WND79)"</div></pre></td></tr></table></figure>
<p>æ³¨å†Œå¼€å‘è€…è´¦å·èƒ½å¤Ÿä»è‹¹æœå¼€å‘è€…ç½‘ç«™è·å–åˆ°é…ç½®æ–‡ä»¶ï¼Œè¿™é‡Œæœ‰ä»½æŒ‡å—ï¼Œå¯ä»¥æŒ‡å¯¼ç¬¬ä¸€æ¬¡åˆ›å»ºç›¸åº”çš„è¯ä¹¦å’Œé…ç½®æ–‡ä»¶ï¼Œ<a href="https://developer.apple.com/library/content/documentation/IDEs/Conceptual/AppDistributionGuide/MaintainingProfiles/MaintainingProfiles.html" target="_blank" rel="external">æˆ³è¿™é‡Œ</a>ã€‚å¯¹äºé‡æ‰“åŒ…æ¥è¯´ï¼Œå¹¶ä¸ç‰¹å®šè¦æ±‚ä½ é€‰æ‹©äº†ä»€ä¹ˆåº”ç”¨IDï¼Œä½ ç”šè‡³å¯ä»¥é‡ç”¨ä¸€ä¸ªå·²ç»å­˜åœ¨çš„IDã€‚æœ€é‡è¦çš„äº‹æƒ…æ˜¯æ‹¥æœ‰ä¸€ä»½åŒ¹é…çš„é…ç½®æ–‡ä»¶ã€‚ç¡®ä¿ä½ åˆ›å»ºäº†ä¸€ä»½å¼€å‘ç¯å¢ƒçš„é…ç½®æ–‡ä»¶ï¼Œè€Œä¸æ˜¯ä¸€ä»½å‘å¸ƒæè¿°æ–‡ä»¶ï¼Œè¿™æ ·ä½ æ‰èƒ½å¯¹appè¿›è¡Œè°ƒè¯•ã€‚</p>
<p>åœ¨ä»¥ä¸‹çš„shellå‘½ä»¤åˆ—è¡¨ä¸­ï¼Œæˆ‘å°†ä¼šä½¿ç”¨æˆ‘å…¬å¸çš„å¼€å‘å›¢é˜Ÿå…³è”çš„ä¸ªäººç­¾åèº«ä»½ã€‚å¹¶åˆ›å»ºäº†ä¸€ä¸ªåº”ç”¨idä¸ºâ€sg.vp.repackagedâ€,ä»¥åŠä¸€å°†é…ç½®æ–‡ä»¶å–åä¸ºâ€AwesomeRepackagingâ€ï¼Œè¿™æ ·ç”Ÿæˆå‡ºæ¥çš„é…ç½®æ–‡ä»¶å°±æ˜¯â€AwesomeRepacaging.mobileprovisionâ€â€”â€”è¿™é‡Œéœ€è¦æ›´æ¢æˆä½ è‡ªå·±çš„idåå’Œé…ç½®æ–‡ä»¶åã€‚</p>
<h4 id="ä½¿ç”¨å¸¸è§„çš„iTunesè´¦å·ï¼š"><a href="#ä½¿ç”¨å¸¸è§„çš„iTunesè´¦å·ï¼š" class="headerlink" title="ä½¿ç”¨å¸¸è§„çš„iTunesè´¦å·ï¼š"></a>ä½¿ç”¨å¸¸è§„çš„iTunesè´¦å·ï¼š</h4><p>è™½ç„¶ä½ ä¸æ˜¯ä¸€ä¸ªä»˜è´¹å¼€å‘è€…ï¼Œä½†è‹¹æœè¿˜æ˜¯æä¾›äº†ä¸€ä¸ªå…è´¹çš„å¼€å‘è€…é…ç½®æ–‡ä»¶ã€‚ä½ å¯ä»¥åœ¨Xcodeé‡Œé¢ä½¿ç”¨ä½ çš„Appleè´¦å·è·å–è¿™ä¸ªé…ç½®æ–‡ä»¶ï¼Œåªéœ€ç®€å•çš„ç¼–è¯‘ä¸€ä¸ªç©ºçš„iOSå·¥ç¨‹ï¼Œç„¶åä»appèµ„æºåŒ…é‡Œé¢æå–å‡ºè¿™ä¸ª<strong>embedded.mobileprovision</strong>ï¼Œå…·ä½“å¯ä»¥å‚è€ƒ<a href="https://www.nccgroup.trust/au/about-us/newsroom-and-events/blogs/2016/october/ios-instrumentation-without-jailbreak/" target="_blank" rel="external">NCC blog</a>çš„è¿™ç¯‡åšæ–‡ã€‚</p>
<p>å½“ä½ è·å–åˆ°è¿™ä¸ªé…ç½®æ–‡ä»¶åï¼Œä½ å¯ä»¥ä½¿ç”¨<strong>security</strong>è¿™ä¸ªå·¥å…·æ¥æŸ¥çœ‹å®ƒçš„å†…å®¹ã€‚é™¤äº†è®¸å¯è¯ä¹¦ä»¥åŠè®¾å¤‡å¤–ï¼Œä½ è¿˜èƒ½åœ¨è¿™ä¸ªæè¿°æ–‡ä»¶æ‰¾åˆ°appçš„æƒé™æˆæƒè¡¨ã€‚åœ¨ä¹‹åçš„ä»£ç ç­¾åé‡Œé¢ï¼Œä½ éœ€è¦è¿™ä¸ªè¡¨ï¼Œæ‰€ä»¥ä¸‹é¢å°†æ¼”ç¤ºå¦‚ä½•å°†ä»–ä»¬æå–å‡ºæ¥åˆ°ä¸€ä¸ªplistæ ¼å¼çš„æ–‡ä»¶é‡Œã€‚ä¹Ÿå¯ä»¥çœ‹çœ‹æ–‡ä»¶çš„å†…å®¹ï¼Œçœ‹çœ‹æ˜¯å¦å¦‚é¢„æœŸèˆ¬ã€‚</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line"><span class="meta">$</span> security cms -D -i AwesomeRepackaging.mobileprovision &gt; profile.plist</div><div class="line"><span class="meta">$</span> /usr/libexec/PlistBuddy -x -c 'Print :Entitlements' profile.plist &gt; entitlements.plist</div><div class="line"><span class="meta">$</span> cat entitlements.plist</div><div class="line">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</div><div class="line">&lt;!DOCTYPE plist PUBLIC "-//Apple//DTD PLIST 1.0//EN" "http://www.apple.com/DTDs/PropertyList-1.0.dtd"&gt;</div><div class="line">&lt;plist version="1.0"&gt;</div><div class="line">&lt;dict&gt;</div><div class="line">&lt;key&gt;application-identifier&lt;/key&gt;</div><div class="line">&lt;string&gt;LRUD9L355Y.sg.vantagepoint.repackage&lt;/string&gt;</div><div class="line">&lt;key&gt;com.apple.developer.team-identifier&lt;/key&gt;</div><div class="line">&lt;string&gt;LRUD9L355Y&lt;/string&gt;</div><div class="line">&lt;key&gt;get-task-allow&lt;/key&gt;</div><div class="line">&lt;true/&gt;</div><div class="line">&lt;key&gt;keychain-access-groups&lt;/key&gt;</div><div class="line">&lt;array&gt;</div><div class="line">&lt;string&gt;LRUD9L355Y.*&lt;/string&gt;</div><div class="line">&lt;/array&gt;</div><div class="line">&lt;/dict&gt;</div><div class="line">&lt;/plist&gt;</div></pre></td></tr></table></figure>
<p>æ³¨æ„åˆ°æˆ‘ä»¬çš„App IDæ˜¯ç”±å›¢é˜Ÿæ ‡è¯†ç¬¦ï¼ˆLRUD9L355Yï¼‰ä»¥åŠåŒ…å(sg.vantagepoint.repackage)ç»„åˆè€Œæˆçš„ã€‚è¿™ä¸ªé…ç½®æ–‡ä»¶åªå¯¹æºå¸¦è¿™æ ·ç‰¹å®šçš„app idæ‰æœ‰æ•ˆã€‚â€œget-task-allowâ€è¿™ä¸ªé”®éå¸¸é‡è¦ï¼Œå½“å®ƒä¸ºtrueæ—¶ï¼Œåƒdebugging serverè¿™æ ·çš„å…¶ä»–è¿›ç¨‹æ‰èƒ½å¤Ÿé™„åŠ åˆ°è¿™ä¸ªappã€‚å¯æƒ³è€ŒçŸ¥ï¼Œåœ¨å‘å¸ƒæè¿°æ–‡ä»¶é‡Œé¢ï¼Œè¿™ä¸ªé”®çš„å€¼è‚¯å®šæ˜¯falseçš„ã€‚</p>
<h4 id="å…¶ä»–å‡†å¤‡å·¥ä½œ"><a href="#å…¶ä»–å‡†å¤‡å·¥ä½œ" class="headerlink" title="å…¶ä»–å‡†å¤‡å·¥ä½œ"></a>å…¶ä»–å‡†å¤‡å·¥ä½œ</h4><p>ä¸ºäº†åœ¨æˆ‘ä»¬çš„appå¯åŠ¨çš„æ—¶å€™åŠ è½½ä¸€ä¸ªé™„åŠ çš„åº“ï¼Œæˆ‘ä»¬éœ€è¦æ’å…¥ä¸€æ¡é¢å¤–çš„åŠ è½½å‘½ä»¤åˆ°ä¸»ç¨‹åºçš„Mach-Oå¤´ä¸­ã€‚è¿™é‡Œæˆ‘ä»¬ä½¿ç”¨<a href="https://github.com/alexzielenski/optool" target="_blank" rel="external">optool</a>å·¥å…·æ¥è‡ªåŠ¨åŒ–è¿™ä¸ªå·¥ç¨‹ï¼š</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="meta">$</span> git clone https://github.com/alexzielenski/optool.git</div><div class="line"><span class="meta">$</span> cd optool/</div><div class="line"><span class="meta">$</span> git submodule update --init --recursive</div></pre></td></tr></table></figure>
<p>æˆ‘ä»¬ä¹Ÿå°†ä½¿ç”¨åˆ°<a href="https://github.com/phonegap/ios-deploy" target="_blank" rel="external">ios-deploy</a>è¿™ä¸ªå·¥å…·ï¼Œè¿™ä¸ªå·¥å…·èƒ½å¤Ÿåœ¨ä¸ä½¿ç”¨Xcodeçš„æƒ…å†µä¸‹å‘å¸ƒæˆ–è€…è°ƒè¯•iOSã€‚ï¼ˆnpmæ˜¯Nodejsçš„åŒ…ç®¡ç†å™¨ï¼Œå¦‚æœä½ è¿˜æ²¡æœ‰å®‰è£…<a href="https://nodejs.org/en/" target="_blank" rel="external">Nodejs</a>ï¼Œä½ å¯ä»¥ä½¿ç”¨homebrewæ¥å®‰è£…ï¼Œæˆ–è€…åˆ°å®˜ç½‘ç›´æ¥ä¸‹è½½å®‰è£…åŒ…ï¼‰</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="meta">$</span> npm install -g ios-deploy</div></pre></td></tr></table></figure>
<p>å¦å¤–ï¼Œåœ¨æ•™ç¨‹å¼€å§‹å‰ï¼Œä½ è¿˜éœ€è¦å…ˆæŠŠ FridaGadget.dylib è¿™ä¸ªåŠ¨æ€åº“ä¸‹è½½ä¸‹æ¥ã€‚</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="meta">$</span> curl -O https://build.frida.re/frida/ios/lib/FridaGadget.dylib</div></pre></td></tr></table></figure>
<p>é™¤äº†ä»¥ä¸Šæåˆ°çš„å·¥å…·ï¼Œæˆ‘ä»¬è¿˜éœ€è¦ä½¿ç”¨ä¸€äº›åŸç”Ÿç³»ç»Ÿå·¥å…·å’ŒXcodeçš„ç¼–è¯‘å·¥å…·ï¼Œæ‰€ä»¥ç¡®ä¿ä½ å·²ç»å®‰è£…äº†Xcodeå‘½ä»¤è¡Œå¼€å‘å·¥å…·ã€‚</p>
<h4 id="æ‰“è¡¥ä¸ï¼Œé‡æ‰“åŒ…ä»¥åŠé‡ç­¾å"><a href="#æ‰“è¡¥ä¸ï¼Œé‡æ‰“åŒ…ä»¥åŠé‡ç­¾å" class="headerlink" title="æ‰“è¡¥ä¸ï¼Œé‡æ‰“åŒ…ä»¥åŠé‡ç­¾å"></a>æ‰“è¡¥ä¸ï¼Œé‡æ‰“åŒ…ä»¥åŠé‡ç­¾å</h4><p>æ¥ä¸åŠäº†ï¼Œå¿«ä¸Šè½¦å§ï¼</p>
<p>å¦‚ä½ æ‰€çŸ¥ï¼ŒIPAæ–‡ä»¶å…¶å®ä¸€ç§ZIPå‹ç¼©æ ¼å¼ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥ä½¿ç”¨zipå·¥å…·æ¥è§£å‹ç¼©ã€‚ç„¶åå°†<strong>FridaGadget.dylib</strong>æ‹·è´åˆ°æ–‡ä»¶ç›®å½•ä¸‹ã€‚å¹¶ä¸”ä½¿ç”¨<strong>optool</strong>å·¥å…·å°†ä¸€æ¡åŠ è½½å‘½ä»¤æ’å…¥åˆ°<strong>UnCrackable Level 1</strong>è¿™ä¸ªäºŒè¿›åˆ¶æ–‡ä»¶å†…ã€‚</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="meta">$</span> unzip UnCrackable_Level1.ipa</div><div class="line"><span class="meta">$</span> cp FridaGadget.dylib Payload/UnCrackable\ Level\ 1.app/</div><div class="line"><span class="meta">$</span> optool install -c load -p "@executable_path/FridaGadget.dylib" -t Payload/UnCrackable\ Level\ 1.app/UnCrackable\ Level\ 1</div><div class="line">Found FAT Header</div><div class="line">Found thin header...</div><div class="line">Found thin header...</div><div class="line">Inserting a LC_LOAD_DYLIB command for architecture: arm</div><div class="line">Successfully inserted a LC_LOAD_DYLIB command for arm</div><div class="line">Inserting a LC_LOAD_DYLIB command for architecture: arm64</div><div class="line">Successfully inserted a LC_LOAD_DYLIB command for arm64</div><div class="line">Writing executable to Payload/UnCrackable Level 1.app/UnCrackable Level 1...</div></pre></td></tr></table></figure>
<p>è¿™ç§å¯¹ä¸»ç¨‹åºæ˜æ˜¾çš„ç¯¡æ”¹å°†ä¼šä½¿å¾—å®ƒçš„ä»£ç ç­¾åå¤±æ•ˆã€‚æ‰€ä»¥è¿™ä¸ªæ— æ³•å†éè¶Šç‹±æœºå­ä¸Šé¢è¿è¡Œã€‚æ‰€ä»¥ä½ å°†éœ€è¦æ›¿æ¢æ‰é…ç½®æ–‡ä»¶ï¼Œå¹¶ä½¿ç”¨æè¿°æ–‡ä»¶ä¸­åˆ—ä¸¾çš„è¯ä¹¦å¯¹ä¸»ç¨‹åºå’ŒFridaGadget.dylibè¿›è¡Œé‡æ–°ç­¾åã€‚</p>
<p>ç¬¬ä¸€æ­¥ï¼Œå°†æˆ‘ä»¬çš„è‡ªå·±çš„é…ç½®æ–‡ä»¶æ‹·è´åˆ°èµ„æºåŒ…é‡Œé¢ï¼š</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="meta">$</span> cp AwesomeRepackaging.mobileprovision Payload/UnCrackable\ Level\ 1.app/embedded.mobileprovision\</div></pre></td></tr></table></figure>
<p>ç¬¬äºŒæ­¥ï¼Œæˆ‘ä»¬éœ€è¦ç¡®ä¿åœ¨<strong>Info.plist</strong>ä¸­çš„åŒ…åæ˜¯å¦è·Ÿæˆ‘ä»¬çš„æè¿°æ–‡ä»¶é‡Œé¢æŒ‡å®šçš„ä¸€è‡´ã€‚å› ä¸ºåœ¨é‡ç­¾çš„è¿‡ç¨‹ä¸­ï¼Œ<strong>codesign</strong>ä¼šæ£€æŸ¥æˆ‘ä»¬çš„Info.plistæ–‡ä»¶é‡Œé¢çš„åŒ…åï¼Œå¦‚æœä¸åŒ¹é…åˆ™ä¼šè¿”å›ä¸€ä¸ªé”™è¯¯å€¼ã€‚</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="meta">$</span> /usr/libexec/PlistBuddy -c "Set :CFBundleIdentifier sg.vantagepoint.repackage" Payload/UnCrackable\ Level\ 1.app/Info.plist</div></pre></td></tr></table></figure>
<p>æœ€åï¼Œæˆ‘ä»¬éœ€è¦ä½¿ç”¨ä»£ç ç­¾åå·¥å…·æ¥é‡ç­¾æ‰€æœ‰çš„äºŒè¿›åˆ¶æ–‡ä»¶ï¼š</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="meta">$</span> rm -rf Payload/F/_CodeSignature</div><div class="line"><span class="meta">$</span> /usr/bin/codesign --force --sign 8004380F331DCA22CC1B47FB1A805890AE41C938 Payload/UnCrackable\ Level\ 1.app/FridaGadget.dylib</div><div class="line">Payload/UnCrackable Level 1.app/FridaGadget.dylib: replacing existing signature</div><div class="line"><span class="meta">$</span> /usr/bin/codesign --force --sign 8004380F331DCA22CC1B47FB1A805890AE41C938 --entitlements entitlements.plist Payload/UnCrackable\ Level\ 1.app/UnCrackable\ Level\ 1</div><div class="line">Payload/UnCrackable Level 1.app/UnCrackable Level 1: replacing existing signature</div></pre></td></tr></table></figure>
<h4 id="å®‰è£…å¹¶è¿è¡Œåº”ç”¨"><a href="#å®‰è£…å¹¶è¿è¡Œåº”ç”¨" class="headerlink" title="å®‰è£…å¹¶è¿è¡Œåº”ç”¨"></a>å®‰è£…å¹¶è¿è¡Œåº”ç”¨</h4><p>ç°åœ¨ä½ å¯ä»¥å¼€å§‹éƒ¨ç½²å¹¶è¿è¡Œä¿®æ”¹åçš„appäº†ï¼Œå¦‚ä¸‹æ“ä½œï¼š</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="meta">$</span> ios-deploy --debug --bundle Payload/UnCrackable\ Level\ 1.app/</div></pre></td></tr></table></figure>
<p>å¦‚æœä¸€åˆ‡é¡ºåˆ©çš„è¯ï¼Œappåº”è¯¥ä¼šé™„åŠ <strong>lldb</strong>å¹¶ä»¥è°ƒè¯•æ¨¡å¼è¿è¡Œåœ¨è®¾å¤‡ä¸Šã€‚Fridaç°åœ¨ä¹Ÿé™„åŠ åˆ°åº”ç”¨ä¸Šäº†ï¼Œå¯æ˜¯ä½¿ç”¨<strong>frida-ps</strong>å‘½ä»¤æ¥éªŒè¯ä¸€ä¸‹ï¼š</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="meta">$</span> frida-ps -U</div><div class="line">PID Name</div><div class="line">--- ------</div><div class="line">499 Gadget</div></pre></td></tr></table></figure>
<p>ç°åœ¨ä½ å¯ä»¥ä½¿ç”¨Fridaæ¥æ­£å¸¸è°ƒè¯•ä½ çš„åº”ç”¨äº†ï¼</p>
<h4 id="æ•…éšœæ’é™¤"><a href="#æ•…éšœæ’é™¤" class="headerlink" title="æ•…éšœæ’é™¤"></a>æ•…éšœæ’é™¤</h4><p>å¦‚æœå‘ç”Ÿä»€ä¹ˆé”™è¯¯ï¼Œæœ‰å¯èƒ½æ˜¯é…ç½®æ–‡ä»¶å’Œä»£ç ç­¾åå¤´ä¸åŒ¹é…ï¼Œè¿™ç§æƒ…å†µå»ºè®®é˜…è¯»ä¸€ä¸‹<a href="https://developer.apple.com/library/content/documentation/IDEs/Conceptual/AppDistributionGuide/MaintainingProfiles/MaintainingProfiles.html" target="_blank" rel="external">å®˜æ–¹æ–‡æ¡£</a>ï¼Œäº†è§£ä¸€ä¸‹æ•´ä¸ªç³»ç»Ÿæ˜¯å¦‚ä½•è¿è¡Œçš„ã€‚å¦å¤–è¿˜å¯ä»¥å‚è€ƒ<a href="http://https//developer.apple.com/library/content/technotes/tn2415/_index.html" target="_blank" rel="external">è‹¹æœæˆæƒæ•…éšœæ’é™¤</a>è¿™ä¸ªé¡µé¢ã€‚</p>
<h4 id="å…³äºè¿™ç¯‡æ–‡ä»¶"><a href="#å…³äºè¿™ç¯‡æ–‡ä»¶" class="headerlink" title="å…³äºè¿™ç¯‡æ–‡ä»¶"></a>å…³äºè¿™ç¯‡æ–‡ä»¶</h4><p>è¿™ç¯‡æ–‡ç« æ˜¯<a href="safari-reader://www.vantagepoint.sg/blog/83-mobile-reverse-engineering-unleashed" target="_blank" rel="external">Mobile Reverse Engineering Unleashed</a>çš„ç³»åˆ—ä¹‹ä¸€ã€‚ä½ å¯ä»¥è®¿é—®<a href="http://www.vantagepoint.sg/blog/categories/17-mobile-reverse-engineering" target="_blank" rel="external">è¿™é‡Œ</a>æ¥æŸ¥çœ‹æ›´å¤šç›¸å…³æ–‡ç« ã€‚</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
  </section>

  


          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      

      <section class="site-overview sidebar-panel sidebar-panel-active">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" itemprop="image"
               src="/images/avatar.gif"
               alt="Chensh" />
          <p class="site-author-name" itemprop="name">Chensh</p>
           
              <p class="site-description motion-element" itemprop="description">ä¸¾çœ‰é—´ä»²å¤ï¼Œç»¿è«é‡Œè‰é¸£</p>
          
        </div>
        <nav class="site-state motion-element">

          
            <div class="site-state-item site-state-posts">
              <a href="/archives/">
                <span class="site-state-item-count">6</span>
                <span class="site-state-item-name">Artikel</span>
              </a>
            </div>
          

          

          
            
            
            <div class="site-state-item site-state-tags">
              
                <span class="site-state-item-count">3</span>
                <span class="site-state-item-name">Tags</span>
              
            </div>
          

        </nav>

        

        <div class="links-of-author motion-element">
          
        </div>

        
        

        
        

        


      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright" >
  
  &copy; 
  <span itemprop="copyrightYear">2017</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Chensh</span>
</div>


<div class="powered-by">
  Erstellt mit  <a class="theme-link" href="https://hexo.io">Hexo</a>
</div>

<div class="theme-info">
  Theme -
  <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">
    NexT.Muse
  </a>
</div>


        

        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.2"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.2"></script>



  
  

  
    <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.2"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.2"></script>

  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.2"></script>



  


  




	





  





  






  





  

  

  

  

  

  

</body>
</html>
